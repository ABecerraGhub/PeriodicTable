Sub Project_3_EN(ByVal VecType, m, n, m1, n1 As Integer) ' 3_Elements in P Table_EN

'   Updated: 27/07/25
'   Created by: Ariel R. Becerra, Alvaro Herrera, Martha Molina(21/05/25)
'   Modified by: _________________
'   This file contains the code for your new ScienSolar project.
'   ==============================================================================
'   PROJECT CODE: 3
'
'   INTEGRATION INSTRUCTIONS:
'   Note 1: The project number (3) in the function name must match the entry in the CONFIG sheet project list. Update if necessary.
'   Note 2: This code will be integrated into the main VBA project to automate  project loading and execution.
'   Note 3: Generated formulas and values are limited to the first 30 columns.  Keep all project data within this range for optimal performance.
'
'   STEP-BY-STEP INTEGRATION: ==================
'    1. CONFIG Sheet Setup (for new projects):
'                                      - Navigate to the CONFIG sheet and add a consecutive number to the last row of the projects list (column C, from row 35)
'                                      - Add a descriptive project name in the corresponding language column
'                                      - Replace (if it doesn't match) the number in Sub Project_3 with the new number from the list
'    2. Numbering Validation:
'                                      - Ensure projects in the CONFIG sheet maintain ascending numerical order
'                                      - Only integers are allowed
'    3. VBA Editor Preparation:
'                                      - Open VBA Editor (Alt+F11 Windows / Fn+Option+F11 macOS)
'                                      - Close other workbooks to avoid accidental code placement
'                                      - In the Project Explorer, select an existing module with available space
'                                      - Alternatively, insert a new module (Insert -- > Module)
'    5. Code Implementation:
'                                      - Select all code in this file and copy it
'                                      - Paste at the end of the selected module's code (for new projects)
'                                      - Replace de old code with the new one (for existing projects). Verify the code
'    6. Project Testing:
'                                      - Return to the CONFIG sheet and click 'New Sheet'
'                                      - Select your project from the list and click '+Vector'
'                                      - Large projects require repeated '+Vector' button presses when loading.
'                                      - Verify successful loading in the new sheet
'   SUPPORT AND UPDATES: =====================
'    Visit www.sciensolar.com for latest updates and documentation
'    © ScienSolar - Advanced Solar Project Management
'   ==============================================================================
'
            Cells(m1 - 1, n1 + 2).FormulaR1C1 = "1"
            Cells(m1 - 1, n1).Value = "0"
            Cells(m1 + 0, n1 + 0).FormulaR1C1 = "=IF(R[-1]C=""ENTIRE"",15,33)"
            Cells(m1 + 0, n1 + 1).FormulaR1C1 = "50"
            Cells(m1 + 0, n1 + 2).FormulaR1C1 = "=CONFIG!R3C4"
            Cells(m1 + 0, n1 + 3).FormulaR1C1 = "800"
            Cells(m1 + 0, n1 + 6).FormulaR1C1 = "=CONFIG!R3C8"
            Cells(m1 + 0, n1 + 7).FormulaR1C1 = "8"
            Cells(m1 + 0, n1 + 8).FormulaR1C1 = "Ariel R. Becerra (21/11/23)"
            Cells(m1 + 1, n1 + 2).FormulaR1C1 = "=CONFIG!R4C4"
            Cells(m1 + 1, n1 + 3).FormulaR1C1 = "480"
            Cells(m1 + 1, n1 + 4).FormulaR1C1 = "=CONFIG!R4C6"
            Cells(m1 + 1, n1 + 5).FormulaR1C1 = "0"
            Cells(m1 + 1, n1 + 6).FormulaR1C1 = "=CONFIG!R4C8"
            Cells(m1 + 1, n1 + 7).FormulaR1C1 = "45"
            Cells(m1 + 2, n1 + 0).FormulaR1C1 = "t = 0,046875 s."
            Cells(m1 + 2, n1 + 2).FormulaR1C1 = "=CONFIG!R5C4"
            Cells(m1 + 2, n1 + 3).FormulaR1C1 = "=100/R[5]C[21]"
            Cells(m1 + 2, n1 + 4).FormulaR1C1 = "=CONFIG!R5C6"
            Cells(m1 + 2, n1 + 5).FormulaR1C1 = "15"
            Cells(m1 + 2, n1 + 6).FormulaR1C1 = "=CONFIG!R5C8"
            Cells(m1 + 2, n1 + 7).FormulaR1C1 = "0"
            Cells(m1 + 3, n1 + 0).FormulaR1C1 = "E"
            Cells(m1 + 3, n1 + 1).FormulaR1C1 = "15"
            Cells(m1 + 3, n1 + 2).FormulaR1C1 = "=CONFIG!R6C4"
            Cells(m1 + 3, n1 + 3).FormulaR1C1 = "200"
            Cells(m1 + 3, n1 + 4).FormulaR1C1 = "=CONFIG!R6C6"
            Cells(m1 + 3, n1 + 5).FormulaR1C1 = "15"
       Cells(m1, n1 + 9).FormulaR1C1 = "HELP"
       Dim HELPtxt As String
       HELPtxt = "ELECTROSTATIC FIELD OF THE ELEMENTS OF THE PERIODIC TABLE." & Chr(10) & "" & Chr(10) & "The model calculates the electric field of atoms in the periodic table, both inside and outside of them, using classical physics and without considering the interaction between electrons or electrons with protons. Radii are calculated using Stepler's rules for quantum mechanics. Only the principal quantum number n is taken into account." & Chr(10) & _
"     " & Chr(10) & "CELL SETTINGS:" & Chr(10) & "" & Chr(10) & "A11 = insert the x coordinate" & Chr(10) & "B11 = insert the y coordinate" & Chr(10) & "C11 = insert the z coordinate" & Chr(10) & _
"     " & Chr(10) & "G18 = position of the first atom at the x coordinate" & Chr(10) & "G19 = position of the first atom at the y coordinate" & Chr(10) & _
"     G20 = position of the first atom at the z coordinate" & Chr(10) & "(for other atoms in similar cells at the bottom of the sheet, scroll down)" & Chr(10) & _
"     " & Chr(10) & "Field result at a point:" & Chr(10) & "" & Chr(10) & "Resulting Field:" & Chr(10) & "A12 = E_x;  B12 = E_y;  C12 = E_z;  G10 = E" & Chr(10) & "" & Chr(10) & "Field of the first nuclei: A30, B30, C30." & Chr(10) & _
"     Field of the first electron:  A48, B48, C48. " & Chr(10) & "The same for other nuclei and electrons."
       On Error Resume Next
       Cells(m1, n1 + 9).Comment.text text:=HELPtxt

      ' C—digo para recrear controles
       Dim ws As Worksheet
       Set ws = ThisWorkbook.ActiveSheet

       If m = 3 Then
           PatronW = ActiveSheet.Cells(1, 1).Width
           PatronH = ActiveSheet.Cells(1, 1).Height

             ' ComboBox
             Set dd = ws.DropDowns.Add(Left:=Range("D15").Left + Range("$D$15").Width * 0, Top:=Range("$D$15").Top, Width:=Range("$D$15").Width * 2, Height:=Range("$D$15").Height * 1)
             With dd
                 .Placement = 2
                 .name = "Elements15"
                 .LinkedCell = "$G$16"
                 .AddItem "1 Hydrogen"
                 .AddItem "2 Helium"
                 .AddItem "3 Lithium"
                 .AddItem "4 Beryllium"
                 .AddItem "5 Boron"
                 .AddItem "6 Carbon"
                 .AddItem "7 Nitrogen"
                 .AddItem "8 Oxygen"
                 .AddItem "9 Fluorine"
                 .AddItem "10 Neon"
                 .AddItem "11 Sodium"
                 .AddItem "12 Magnesium"
                 .AddItem "13 Aluminum"
                 .AddItem "14 Silicon"
                 .AddItem "15 Phosphorus"
                 .AddItem "16 Sulfur"
                 .AddItem "17 Chlorine"
                 .AddItem "18 Argon"
                 .AddItem "19 Potassium"
                 .AddItem "20 Calcium"
                 .AddItem "21 Scandium"
                 .AddItem "22 Titanium"
                 .AddItem "23 Vanadium"
                 .AddItem "24 Chromium"
                 .AddItem "25 Manganese"
                 .AddItem "26 Iron"
                 .AddItem "27 Cobalt"
                 .AddItem "28 Nickel"
                 .AddItem "29 Copper"
                 .AddItem "30 Zinc"
                 .AddItem "31 Gallium"
                 .AddItem "32 Germanium"
                 .AddItem "33 Arsenic"
                 .AddItem "34 Selenium"
                 .AddItem "35 Bromine"
                 .AddItem "36 Krypton"
                 .AddItem "37 Rubidium"
                 .AddItem "38 Strontium"
                 .AddItem "39 Yttrium"
                 .AddItem "40 Zirconium"
                 .AddItem "41 Niobium"
                 .AddItem "42 Molybdenum"
                 .AddItem "43 Technetium"
                 .AddItem "44 Ruthenium"
                 .AddItem "45 Rhodium"
                 .AddItem "46 Palladium"
                 .AddItem "47 Silver"
                 .AddItem "48 Cadmium"
                 .AddItem "49 Indium"
                 .AddItem "50 Tin"
                 .AddItem "51 Antimony"
                 .AddItem "52 Tellurium"
                 .AddItem "53 Iodine"
                 .AddItem "54 Xenon"
                 .AddItem "55 Cesium"
                 .AddItem "56 Barium"
                 .AddItem "57 Lanthanum"
                 .AddItem "58 Cerium"
                 .AddItem "59 Praseodymium"
                 .AddItem "60 Neodymium"
                 .AddItem "61 Promethium"
                 .AddItem "62 Samarium"
                 .AddItem "63 Europium"
                 .AddItem "64 Gadolinium"
                 .AddItem "65 Terbium"
                 .AddItem "66 Dysprosium"
                 .AddItem "67 Holmium"
                 .AddItem "68 Erbium"
                 .AddItem "69 Thulium"
                 .AddItem "70 Ytterbium"
                 .AddItem "71 Lutetium"
                 .AddItem "72 Hafnium"
                 .AddItem "73 Tantalum"
                 .AddItem "74 Tungsten"
                 .AddItem "75 Rhenium"
                 .AddItem "76 Osmium"
                 .AddItem "77 Iridium"
                 .AddItem "78 Platinum"
                 .AddItem "79 Gold"
                 .AddItem "80 Mercury"
                 .AddItem "81 Thallium"
                 .AddItem "82 Lead"
                 .AddItem "83 Bismuth"
                 .AddItem "84 Polonium"
                 .AddItem "85 Astatine"
                 .AddItem "86 Radon"
                 .AddItem "87 Francium"
                 .AddItem "88 Radium"
                 .AddItem "89 Actinium"
                 .AddItem "90 Thorium"
                 .AddItem "91 Protactinium"
                 .AddItem "92 Uranium"
                 .AddItem "93 Neptunium"
                 .AddItem "94 Plutonium"
                 .AddItem "95 Americium"
                 .AddItem "96 Curium"
                 .AddItem "97 Berkelium"
                 .AddItem "98 Californium"
                 .AddItem "99 Einsteinium"
                 .AddItem "100 Fermium"
                 .AddItem "101 Mendelevium"
                 .AddItem "102 Nobelium"
                 .AddItem "103 Lawrencium"
                 .AddItem "104 Rutherfordium"
                 .AddItem "105 Dubnium"
                 .AddItem "106 Seaborgium"
                 .AddItem "107 Bohrium"
                 .AddItem "108 Hassium"
                 .AddItem "109 Meitnerium"
                 .AddItem "110 Darmstadtium"
                 .AddItem "111 Roentgenium"
                 .AddItem "112 Copernicium"
                 .AddItem "113 Nihonium"
                 .AddItem "114 Flerovium"
                 .AddItem "115 Moscovium"
                 .AddItem "116 Livermorium"
                 .AddItem "117 Tennessine"
                 .AddItem "118 Oganesson"
                 .ListFillRange = ""
                 .Value = 2
                 .Display3DShading = True
             End With
             Set dd = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("F15").Left + Range("$F$15").Width * 0, Top:=Range("$F$15").Top, Width:=Range("$F$15").Width * 1, Height:=Range("$F$15").Height * 1).Select
             With Selection
               .name = "AddButt(15)[68](33)[50]1PT"
               .OnAction = "PTableRefresh"
               .text = "Refresh"
             End With

             ' ComboBox
             Set dd = ws.DropDowns.Add(Left:=Range("L8").Left + Range("$L$8").Width * 0, Top:=Range("$L$8").Top, Width:=Range("$L$8").Width * 3.5, Height:=Range("$L$8").Height * 1)
             With dd
                 .Placement = 2
                 .name = "ViewType"
                 .LinkedCell = "$AB$19"
                 .AddItem "1. At a point in space"
                 .AddItem "2: In Cartesian coord. (editable)"
                 .AddItem "3: In Cartesian coord. (default)"
                 .AddItem "4. In cylindrical coordinates"
                 .AddItem "5. In spherical coordinates"
                 .ListFillRange = "$AB$20:$AB$24"
                 .Value = 1
                 .Display3DShading = True
             End With
             Set dd = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("O8").Left + Range("$O$8").Width * 0.5, Top:=Range("$O$8").Top, Width:=Range("$O$8").Width * 1, Height:=Range("$O$8").Height * 1).Select
             With Selection
               .name = "FieldButton"
               .OnAction = "Rotate"
               .text = "" & ChrW(8629) & "  Field"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("G15").Left + Range("$G$15").Width * 0, Top:=Range("$G$15").Top, Width:=Range("$G$15").Width * 1.5, Height:=Range("$G$15").Height * 1).Select
             With Selection
               .name = "AddButt(15)[68](33)[50]2PT"
               .OnAction = "PTableDuplicateAtom"
               .text = "Duplicate Atom"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("H15").Left + Range("$H$15").Width * 0.5, Top:=Range("$H$15").Top, Width:=Range("$H$15").Width * 0.5, Height:=Range("$H$15").Height * 1).Select
             With Selection
               .name = "DelButt(15)[68](33)[50]3PT"
               .OnAction = "PTableDuplicateAtom"
               .text = "X"
             End With

             ' Opton button
             Set opt = ws.OptionButtons.Add(Left:=Range("R8").Left + Range("$R$8").Width * 0, Top:=Range("$R$8").Top, Width:=Range("$R$8").Width * 0.5, Height:=Range("$R$8").Height * 1.5)
             opt.Caption = ""
             With opt
              .name = "YesOptionButt"
              .LinkedCell = "$T$8"
             End With
             Set opt = Nothing

             ' Opton button
             Set opt = ws.OptionButtons.Add(Left:=Range("S8").Left + Range("$S$8").Width * 0, Top:=Range("$S$8").Top, Width:=Range("$S$8").Width * 0.5, Height:=Range("$S$8").Height * 1.5)
             opt.Caption = ""
             With opt
              .name = "NoOptionButt"
              .LinkedCell = "$T$8"
             End With
             Set opt = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("T8").Left + Range("$T$8").Width * 0, Top:=Range("$T$8").Top, Width:=Range("$T$8").Width * 1, Height:=Range("$T$8").Height * 1).Select
             With Selection
               .name = "DelTableButt"
               .OnAction = "PTCleanTable"
               .text = "Clear data"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("H8").Left + Range("$H$8").Width * 0, Top:=Range("$H$8").Top, Width:=Range("$H$8").Width * 1.5, Height:=Range("$H$8").Height * 1).Select
             With Selection
               .name = "RotElecButt"
               .OnAction = "PTRotateElectrons"
               .text = " " & ChrW(8634) & "  Electrons  " & ChrW(8630) & ""
             End With

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("F8").Left + Range("$F$8").Width * 0, Top:=Range("$F$8").Top, Width:=Range("$F$8").Width * 0.5, Height:=Range("$F$8").Height * 1)
             spin.name = "SpinnerB8L"
             spin.LinkedCell = "$F$8"
             spin.Min = 20
             spin.max = 30000
             spin.Value = 30
             spin.SmallChange = 2
             spin.Value = 30
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("G8").Left + Range("$G$8").Width * 0, Top:=Range("$G$8").Top, Width:=Range("$G$8").Width * 0.5, Height:=Range("$G$8").Height * 1)
             spin.name = "SpinnerB8R"
             spin.LinkedCell = "$G$8"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 1
             spin.SmallChange = 1
             spin.Value = 1
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("E19").Left + Range("$E$19").Width * 0.5, Top:=Range("$E$19").Top, Width:=Range("$E$19").Width * 0.5, Height:=Range("$E$19").Height * 1)
             spin.name = "Spinner 1213"
             spin.LinkedCell = "$E$20"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 0
             spin.SmallChange = 1
             spin.Value = 0
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("E19").Left + Range("$E$19").Width * 0, Top:=Range("$E$19").Top, Width:=Range("$E$19").Width * 0.5, Height:=Range("$E$19").Height * 1)
             spin.name = "Spinner 1214"
             spin.LinkedCell = "$D$20"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 0
             spin.SmallChange = 1
             spin.Value = 0
             spin.OnAction = "Rotate"
             Set spin = Nothing

       End If

          Dim p As Integer
          For p = 1 To 0
          If Range("A5").Value = "Next sub_i" Then Exit Sub
                 Application.Run "Project_46_" & p & "_EN", VecType, m, n, m1, n1 '
          Next p

      If m = m1 + 0 Then ' vector 7
            Cells(m + 3, n + -1).FormulaR1C1 = "1"
            Cells(m + 3, n + 0).FormulaR1C1 = "E"
            Cells(m + 3, n + 1).FormulaR1C1 = "15"
            Cells(m + 3, n + 2).FormulaR1C1 = "=CONFIG!R6C4"
            Cells(m + 3, n + 3).FormulaR1C1 = "200"
            Cells(m + 3, n + 4).FormulaR1C1 = "=CONFIG!R6C6"
            Cells(m + 3, n + 5).FormulaR1C1 = "15"
            Cells(m + 3, n + 9).FormulaR1C1 = "Vectors visually modified (magnitude unchanged). Adjust scale in  B8"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 1).FormulaR1C1 = "=IF(R[12]C[25]=1,"""",IF(R[12]C[25]=2,R[14]C[24],IF(R[12]C[25]=3,R[15]C[24],IF(R[12]C[25]=4,R[16]C[24],IF(R[12]C[25]=5,R[17]C[24])))))"
            Cells(m + 4, n + 2).FormulaR1C1 = "Electric field of atoms."
            Cells(m + 4, n + 12).FormulaR1C1 = "The Coulombic Electrostatic Field of Atoms and Their Combinations"
            Cells(m + 4, n + 24).FormulaR1C1 = "Setup and Instructions"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=IF(R[2]C[24]=1,RC[4] &""*""&RC[5],RC[4] &""*""&RC[5] &""E+20"")"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "Adjust Vector Size:"
            Cells(m + 5, n + 4).FormulaR1C1 = "30"
            Cells(m + 5, n + 5).FormulaR1C1 = "1"
            Cells(m + 5, n + 8).FormulaR1C1 = "View of the field:"
            Cells(m + 5, n + 15).FormulaR1C1 = "Data:"
            Cells(m + 5, n + 16).FormulaR1C1 = "Yes"
            Cells(m + 5, n + 17).FormulaR1C1 = "No"
            Cells(m + 5, n + 18).FormulaR1C1 = "2"
            Cells(m + 6, n + -1).FormulaR1C1 = "=SUMIFS(C[2],C[3],""E_*"")"
            Cells(m + 6, n + 0).FormulaR1C1 = "=SUMIFS(C[-1],C[2],""E_*"")"
            Cells(m + 6, n + 1).FormulaR1C1 = "=SUMIFS(C[-1],C[1],""E_*"")"
            Cells(m + 6, n + 2).FormulaR1C1 = "Total charges:"
            Cells(m + 6, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],""E_*"")"
            Cells(m + 6, n + 4).FormulaR1C1 = "=""  E  "" & IF(R[1]C[20]=1,""(V/" & ChrW(197) & ")"",""(V/m)"")&"" ="""
            Cells(m + 6, n + 5).FormulaR1C1 = "=SQRT(R[3]C[-6]^2+R[3]C[-5]^2+R[3]C[-4]^2)"
            Cells(m + 6, n + 6).FormulaR1C1 = "=IF(R[10]C[20]=1,""   Edit the observation point in A11, B11, C11)"",IF(R[10]C[20]=2,""       Edit the parameters in SETTINGS (cells Y12 -AC14) -- >> "",IF(R[10]C[20]=3,""       Edit the parameters in SETTINGS (cell AA22) -- >> "",IF(R[10]C[20]=4,""      Edit the parameters in SETTINGS (cells Y14 - AA16) --- >> "",IF(R[10]C[20]=5,""       Edit the parameters in SETTINGS (cells Y15 - AA17) -- >> "","""")))))"
            Cells(m + 6, n + 14).FormulaR1C1 = "=IF(R[-1]C[4]=1,""      The data is extracted into a table starting with row 46."","""")"
            Cells(m + 6, n + 20).FormulaR1C1 = "/////////////////////////////////////////////////////// SETTINGS ///////////////////////////////////////////////"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 2).FormulaR1C1 = "Total atoms:"
            Cells(m + 7, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],""E_0"")"
            Cells(m + 7, n + 4).FormulaR1C1 = "            k    ="
            Cells(m + 7, n + 5).FormulaR1C1 = "=IF(RC[19]=1,0.89875517923*(100000000000000000000),0.89875517923/RC[19])"
            Cells(m + 7, n + 20).FormulaR1C1 = "___________________________________"
            Cells(m + 7, n + 23).FormulaR1C1 = "        1 " & ChrW(197) & " ="
            Cells(m + 7, n + 24).FormulaR1C1 = "1"
            Cells(m + 7, n + 25).FormulaR1C1 = "       _______________________________"
            Cells(m + 8, n + -1).FormulaR1C1 = "0"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 2).FormulaR1C1 = "=""<< --- Enter (x, y, z)  "" & IF(R[-1]C[22]=1,""(in Angstrom " & ChrW(197) & ")"",""(in meters)"")"
            Cells(m + 8, n + 20).FormulaR1C1 = "PERIODIC"
            Cells(m + 8, n + 21).FormulaR1C1 = "|  Field Display Parameters:"
            Cells(m + 8, n + 25).FormulaR1C1 = "    Step:"
            Cells(m + 8, n + 26).FormulaR1C1 = "|      Move the coordinates:"
            Cells(m + 9, n + -1).FormulaR1C1 = "=R[-3]C[1]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=R[-3]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=R[-3]C[-2]"
            Cells(m + 9, n + 20).FormulaR1C1 = "TABLE"
            Cells(m + 9, n + 21).FormulaR1C1 = "|"
            Cells(m + 9, n + 22).FormulaR1C1 = "X_in -X_fin ="
            Cells(m + 9, n + 23).FormulaR1C1 = "=0*R[-2]C[1]"
            Cells(m + 9, n + 24).FormulaR1C1 = "=0*R[-2]C"
            Cells(m + 9, n + 25).FormulaR1C1 = "=0.2*R[-2]C[-1]"
            Cells(m + 9, n + 26).FormulaR1C1 = "|      by x:"
            Cells(m + 9, n + 27).FormulaR1C1 = "0"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "=IF(R[-5]C[18]=1,50,0)"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 20).FormulaR1C1 = "Hydrogen,Helium,Lithium,Beryllium,Boron,Carbon,Nitrogen,Oxygen,Fluorine,Neon,Sodium,Magnesium,Aluminum,Silicon,Phosphorus,Sulfur,Chlorine,Argon,Potassium,Calcium,Scandium,Titanium,Vanadium,Chromium,Manganese,Iron,Cobalt,Nickel,Copper,Zinc,Gallium,Germanium,Arsenic,Selenium,Bromine,Krypton,Rubidium,Strontium,Yttrium,Zirconium,Niobium,Molybdenum,Technetium,Ruthenium,Rhodium,Palladium,Silver,Cadmium,Indium,Tin,Antimony,Tellurium,Iodine,Xenon,Cesium,Barium, Lanthanum, Cerium, Prasedymium, Neodymium, Promecio,"
            Cells(m + 10, n + 21).FormulaR1C1 = "|"
            Cells(m + 10, n + 22).FormulaR1C1 = "Y_in -Y_fin ="
            Cells(m + 10, n + 23).FormulaR1C1 = "=-3*R[-3]C[1]"
            Cells(m + 10, n + 24).FormulaR1C1 = "=3*R[-3]C"
            Cells(m + 10, n + 25).FormulaR1C1 = "=0.3*R[-3]C[-1]"
            Cells(m + 10, n + 26).FormulaR1C1 = "|      by y:"
            Cells(m + 10, n + 27).FormulaR1C1 = "=1*R[-3]C[-3]"
            Cells(m + 11, n + -1).FormulaR1C1 = "4"
            Cells(m + 11, n + 0).FormulaR1C1 = "=IF(R[-6]C[18]=1,10,0)"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 20).FormulaR1C1 = "Samarium, Europium, Gadolinium, Terbium, Dysprosium, Holmium, Erbium, Thulium, Ytterbium, Lutetium, Hafnium, Tantalum, Tungsten, Rhenium, Osmium, Iridium, Platinum, Gold, Mercury, Thallium, Lead, Bismuth, Polonium, Astatine, Radon, Francium, Radium, Actinium, Thorium, Protactinium, Uranium, Neptunium, Plutonium, Americium, Curium, Berkelium, Californium, Einsteinium, Fermium, Mendelevium, Nobelium, Lawrencium, Rutherfordium, Dubnium, Seaborgium, Bohrium, Hassium, Meitnerium, Darmstadtium, Roentgenium, Copernicium, Nihonium, Flerovium, Moscovium, Livermorium, Tennessine, Oganesson,"
            Cells(m + 11, n + 21).FormulaR1C1 = "|"
            Cells(m + 11, n + 22).FormulaR1C1 = "Z_in -Z_fin ="
            Cells(m + 11, n + 23).FormulaR1C1 = "=-2*R[-4]C[1]"
            Cells(m + 11, n + 24).FormulaR1C1 = "=2*R[-4]C"
            Cells(m + 11, n + 25).FormulaR1C1 = "=0.2*R[-4]C[-1]"
            Cells(m + 11, n + 26).FormulaR1C1 = "|      by z:"
            Cells(m + 11, n + 27).FormulaR1C1 = "0"
            Cells(m + 3, n + 1).Interior.Color = "13998939"
            Cells(m + 3, n + 1).Font.Size = "14"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = "+         He"
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 9 Then ' vector 6
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(RC[1]<0, ""-          "", ""+         "") &R[1]C[3]"
            Cells(m + 3, n + 1).FormulaR1C1 = "=R[1]C[4]*1.6E-19"
            Cells(m + 3, n + 2).FormulaR1C1 = "||||||||||||||||||||||||||||||||||||||"
            Cells(m + 3, n + 5).FormulaR1C1 = "=MID(R[-2]C[15]&R[-1]C[15],IFERROR(FIND(""|"", SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","",""|"",R[1]C-1)),0)+1,FIND("";"",SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","","";"",R[1]C))-IFERROR(FIND(""|"", SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","",""|"",R[1]C-1)),0)-1)"
            Cells(m + 3, n + 20).FormulaR1C1 = "|1,H,1,|2,He,2,"
            Cells(m + 3, n + 21).FormulaR1C1 = "|"
            Cells(m + 3, n + 22).FormulaR1C1 = "rho_i -rho_f ="
            Cells(m + 3, n + 23).FormulaR1C1 = "=2*R[-5]C[1]"
            Cells(m + 3, n + 24).FormulaR1C1 = "=2*R[-5]C"
            Cells(m + 3, n + 25).FormulaR1C1 = "=0.3*R[-5]C[-1]"
            Cells(m + 3, n + 26).FormulaR1C1 = "|         Color:"
            Cells(m + 3, n + 27).FormulaR1C1 = "=10/R[-5]C[-3]"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=9"
            Cells(m + 4, n + 2).FormulaR1C1 = "Symbol:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=MID(R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[26]C[1]+1,R[27]C[1]-R[26]C[1]-1)"
            Cells(m + 4, n + 4).FormulaR1C1 = "         Z ="
            Cells(m + 4, n + 5).FormulaR1C1 = "2"
            Cells(m + 4, n + 6).FormulaR1C1 = "=IF(R[1]C[-3]<RC[-1],""< - Change element, or increase"" &RC[-1]-R[1]C[-3] & ""  electron(s) using the Refresh button"",IF(R[1]C[-3]>RC[-1],""< - Change element, or remove "" &R[1]C[-3]-RC[-1] & "" electron(s) using the Refresh button."",""""))"
            Cells(m + 4, n + 20).FormulaR1C1 = "|3,Li,2,1,|4,Be,2,2,|5,B,2,3,|6,C,2,4,|7,N,2,5,|8,O,2,6,|9,F,2,7,|10,Ne,2,8,"
            Cells(m + 4, n + 21).FormulaR1C1 = "|"
            Cells(m + 4, n + 22).FormulaR1C1 = "phi_i -phi_f ="
            Cells(m + 4, n + 23).FormulaR1C1 = "0"
            Cells(m + 4, n + 24).FormulaR1C1 = "360"
            Cells(m + 4, n + 25).FormulaR1C1 = "10"
            Cells(m + 4, n + 26).FormulaR1C1 = "|      (in AD15 goes the magnitude "
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "1"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "Electrons:"
            Cells(m + 5, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-1]C&R[-2]C[-4]&""_*"")+COUNTIF(C[-1],R[-1]C&""_r_ion"")"
            Cells(m + 5, n + 5).FormulaR1C1 = "=IF(R[-1]C>RC[-2],R[-1]C[-2]&"" +""&ABS(R[-1]C-RC[-2]),IF(R[-1]C<RC[-2],R[-1]C[-2]&"" -""&ABS(R[-1]C-RC[-2]),""""))"
            Cells(m + 5, n + 20).FormulaR1C1 = "|11,Na,2,8,1,|12,Mg,2,8,2,|13,Al,2,8,3,|14,Si,2,8,4,|15,P,2,8,5,|16,S,2,8,6,|17,Cl,2,8,7,|18,Ar,2,8,8,"
            Cells(m + 5, n + 21).FormulaR1C1 = "|"
            Cells(m + 5, n + 22).FormulaR1C1 = "theta_i -theta_f ="
            Cells(m + 5, n + 23).FormulaR1C1 = "0"
            Cells(m + 5, n + 24).FormulaR1C1 = "180"
            Cells(m + 5, n + 25).FormulaR1C1 = "10"
            Cells(m + 5, n + 26).FormulaR1C1 = "|         of the largest vector)."
            Cells(m + 6, n + 2).FormulaR1C1 = "Position x,y,z of the atom:"
            Cells(m + 6, n + 4).FormulaR1C1 = "=""x ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 6, n + 5).FormulaR1C1 = "0"
            Cells(m + 6, n + 20).FormulaR1C1 = "|19,K,2,8,8,1,|20,Ca,2,8,8,2,|21,Sc,2,8,9,2,|22,Ti,2,8,10,2,|23,V,2,8,11,2,|24,Cr,2,8,13,1,|25,Mn,2,8,13,2,|26,Fe,2,8,14,2,|27,Co,2,8,15,2,|28,Ni,2,8,16,2,|29,Cu,2,8,18,1,|30,Zn,2,8,18,2,|31,Ga,2,8,18,3,|32,Ge,2,8,18,4,|33,As,2,8,18,5,|34,Se,2,8,18,6,|35,Br,2,8,18,7,|36,Kr,2,8,18,8,"
            Cells(m + 6, n + 21).FormulaR1C1 = "|__________________________________________________________________________________"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Rotate:"
            Cells(m + 7, n + 3).FormulaR1C1 = "0"
            Cells(m + 7, n + 4).FormulaR1C1 = "=""y ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 7, n + 5).FormulaR1C1 = "0"
            Cells(m + 7, n + 20).FormulaR1C1 = "|37,Rb,2,8,18,8,1,|38,Sr,2,8,18,8,2,|39,Y,2,8,18,9,2,|40,Zr,2,8,18,10,2,|41,Nb,2,8,18,12,1,|42,Mo,2,8,18,13,1,|43,Tc,2,8,18,13,2,|44,Ru,2,8,18,15,1,|45,Rh,2,8,18,16,1,|46,Pd,2,8,18,18,,|47,Ag,2,8,18,18,1,|48,Cd,2,8,18,18,2,|49,In,2,8,18,18,3,|50,Sn,2,8,18,18,4,|51,Sb,2,8,18,18,5,|52,Te,2,8,18,18,6,|53,I,2,8,18,18,7,|54,Xe,2,8,18,18,8,"
            Cells(m + 7, n + 21).FormulaR1C1 = "|     Distribution of electrons"
            Cells(m + 7, n + 24).FormulaR1C1 = "|"
            Cells(m + 7, n + 25).FormulaR1C1 = "Views:"
            Cells(m + 7, n + 26).FormulaR1C1 = "1"
            Cells(m + 8, n + 2).FormulaR1C1 = "0"
            Cells(m + 8, n + 3).FormulaR1C1 = "0"
            Cells(m + 8, n + 4).FormulaR1C1 = "=""z ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 8, n + 5).FormulaR1C1 = "0"
            Cells(m + 8, n + 20).FormulaR1C1 = "|55,Cs,2,8,18,18,8,1,|56,Ba,2,8,18,18,8,2,|57,La,2,8,18,18,9,2,|58,Ce,2,8,18,19,9,2,|59,Pr,2,8,18,21,8,2,|60,Nd,2,8,18,22,8,2,|61,Pm,2,8,18,23,8,2,|62,Sm,2,8,18,24,8,2,|63,Eu,2,8,18,25,8,2,|64,Gd,2,8,18,25,9,2,|65,Tb,2,8,18,27,8,2,|66,Dy,2,8,18,28,8,2,|67,Ho,2,8,18,29,8,2,|68,Er,2,8,18,30,8,2,|69,Tm,2,8,18,31,8,2,|70,Yb,2,8,18,32,8,2,|71,Lu,2,8,18,32,9,2,|72,Hf,2,8,18,32,10,2,|73,Ta,2,8,18,32,11,2,|74,W,2,8,18,32,12,2,|75,Re,2,8,18,32,13,2,|76,Os,2,8,18,32,14,2,|77,Ir,2,8,18,32,15,2,|78,Pt,2,8,18,32,17,1,|79,Au,2,8,18,32,18,1,|80,Hg,2,8,18,32,18,2,|81,Tl,2,8,18,32,18,3,|82,Pb,2,8,18,32,18,4,|83,Bi,2,8,18,32,18,5,|84,Po,2,8,18,32,18,6,|85,At,2,8,18,32,18,7,|86,Rn,2,8,18,32,18,8,"
            Cells(m + 8, n + 21).FormulaR1C1 = "|    in the atom (spherical distribution"
            Cells(m + 8, n + 24).FormulaR1C1 = "|"
            Cells(m + 8, n + 26).FormulaR1C1 = "1. At a point in space"
            Cells(m + 9, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 9, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 9, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 9, n + 2).FormulaR1C1 = "Distrib. of electrons:"
            Cells(m + 9, n + 4).FormulaR1C1 = "   Radius:"
            Cells(m + 9, n + 5).FormulaR1C1 = "Value:"
            Cells(m + 9, n + 20).FormulaR1C1 = "|87,Fr,2,8,18,32,18,8,1,|88,Ra,2,8,18,32,18,8,2,|89,Ac,2,8,18,32,18,9,2,|90,Th,2,8,18,32,18,10,2,|91,Pa,2,8,18,32,20,9,2,|92,U,2,8,18,32,21,9,2,|93,Np,2,8,18,32,22,9,2,|94,Pu,2,8,18,32,24,8,2,|95,Am,2,8,18,32,25,8,2,|96,Cm,2,8,18,32,25,9,2,|97,Bk,2,8,18,32,27,8,2,|98,Cf,2,8,18,32,28,8,2,|99,Es,2,8,18,32,29,8,2,|100,Fm,2,8,18,32,30,8,2,|101,Md,2,8,18,32,31,8,2,|102,No,2,8,18,32,32,8,2,|103,Lr,2,8,18,32,32,8,3,|104,Rf,2,8,18,32,32,10,2,|105,Db,2,8,18,32,32,11,2,|106,Sg,2,8,18,32,32,12,2,|107,Bh,2,8,18,32,32,13,2,|108,Hs,2,8,18,32,32,14,2,|109,Mt,2,8,18,32,32,15,2,|110,Ds,2,8,18,32,32,16,2,|111,Rg,2,8,18,32,32,17,2,|112,Cn,2,8,18,32,32,18,2,|113,Nh,2,8,18,32,32,18,3,|114,Fl,2,8,18,32,32,18,4,|115,Mc,2,8,18,32,32,18,5,|116,Lv,2,8,18,32,32,18,6,|117,Ts,2,8,18,32,32,18,7,|118,Og,2,8,18,32,32,18,8,"
            Cells(m + 9, n + 21).FormulaR1C1 = "|                   in A37, B37, C37):"
            Cells(m + 9, n + 24).FormulaR1C1 = "|"
            Cells(m + 9, n + 25).FormulaR1C1 = "=""o[""&R[-9]C&""]x=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]o2[""&R[-8]C&""]y=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]o3[""&R[-7]C&""]z=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]color=[""&R[-6]C[2]&""]origin[cart.]=[""&R[-9]C[2]&"";""&R[-8]C[2]&"";""&R[-7]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 9, n + 26).FormulaR1C1 = "2: In Cartesian coord. (editable)"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 2).FormulaR1C1 = "       Total :"
            Cells(m + 10, n + 3).FormulaR1C1 = "=SUM(R[1]C:R[7]C)"
            Cells(m + 10, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_ion"""
            Cells(m + 10, n + 5).FormulaR1C1 = "=IFERROR(VLOOKUP(0,R[1]C[-2]:R[7]C,3,FALSE),"""")"
            Cells(m + 10, n + 20).FormulaR1C1 = "|_________________________________________________________________________________"
            Cells(m + 10, n + 21).FormulaR1C1 = "|         Azimuth and polar ranges:"
            Cells(m + 10, n + 24).FormulaR1C1 = "|"
            Cells(m + 10, n + 25).FormulaR1C1 = "o[0,1]x=[0;0]o2[0,1]y=[-2;3]o3[0,1]z=[-2;3]color=[10]origin[cart.]=[0;0;0]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"
            Cells(m + 10, n + 26).FormulaR1C1 = "3: In Cartesian coord. (default)"
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "8"
            Cells(m + 11, n + 2).FormulaR1C1 = "       En n = 1:"
            Cells(m + 11, n + 3).FormulaR1C1 = "=IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0)"
            Cells(m + 11, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_1"""
            Cells(m + 11, n + 5).FormulaR1C1 = "=(1^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 11, n + 6).FormulaR1C1 = "1s2"
            Cells(m + 11, n + 20).FormulaR1C1 = "|  Phi_ini ="
            Cells(m + 11, n + 21).FormulaR1C1 = "90"
            Cells(m + 11, n + 22).FormulaR1C1 = "Phi_fin ="
            Cells(m + 11, n + 23).FormulaR1C1 = "90"
            Cells(m + 11, n + 24).FormulaR1C1 = "|"
            Cells(m + 11, n + 25).FormulaR1C1 = "=""c[""&R[-8]C&""]rho=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]c2[""&R[-7]C&""]phi=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]c3[""&R[-9]C&""]z=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]color=[""&R[-8]C[2]&""]origin[cart.]=[""&R[-11]C[2]&"";""&R[-10]C[2]&"";""&R[-9]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 11, n + 26).FormulaR1C1 = "4. In cylindrical coordinates"
            Cells(m + 3, n + 1).Interior.Color = "255"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 18 Then ' vector 5
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "       En n = 2:"
            Cells(m + 3, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 3, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_2"""
            Cells(m + 3, n + 5).FormulaR1C1 = "=(2^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 3, n + 20).FormulaR1C1 = "|  Theta_ini="
            Cells(m + 3, n + 21).FormulaR1C1 = "0"
            Cells(m + 3, n + 22).FormulaR1C1 = "Theta_fin="
            Cells(m + 3, n + 23).FormulaR1C1 = "360"
            Cells(m + 3, n + 24).FormulaR1C1 = "|"
            Cells(m + 3, n + 25).FormulaR1C1 = "=""s[""&R[-9]C&""]r=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]s2[""&R[-8]C&""]phi=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]s3[""&R[-7]C&""]theta=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]color=[""&R[-9]C[2]&""]origin[cart.]=[""&R[-12]C[2]&"";""&R[-11]C[2]&"";""&R[-10]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 3, n + 26).FormulaR1C1 = "5. In spherical coordinates"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "       En n = 3:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 4, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_3"""
            Cells(m + 4, n + 5).FormulaR1C1 = "=(3^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 4, n + 20).FormulaR1C1 = "/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 2).FormulaR1C1 = "       En n = 4:"
            Cells(m + 5, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 5, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_4"""
            Cells(m + 5, n + 5).FormulaR1C1 = "=(4^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 5, n + 21).FormulaR1C1 = "1. Set Up an Atom"
            Cells(m + 6, n + 2).FormulaR1C1 = "       En n = 5:"
            Cells(m + 6, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 6, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_5"""
            Cells(m + 6, n + 5).FormulaR1C1 = "=(5^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 6, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 6, n + 22).FormulaR1C1 = "Select the atom from the list and press the Update button."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 2).FormulaR1C1 = "       En n = 6:"
            Cells(m + 7, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 7, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_6"""
            Cells(m + 7, n + 5).FormulaR1C1 = "=(6^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 7, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 7, n + 22).FormulaR1C1 = "Edit its position in space in G18, G19, and G20 for the first atom or in its "
            Cells(m + 8, n + 2).FormulaR1C1 = "       En n = 7:"
            Cells(m + 8, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 8, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_7"""
            Cells(m + 8, n + 5).FormulaR1C1 = "=(7^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 8, n + 22).FormulaR1C1 = "corresponding cells for the other atoms."
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 3).FormulaR1C1 = "  SHIELDING::"
            Cells(m + 9, n + 21).FormulaR1C1 = "2. Adding a New Atom:"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 2).FormulaR1C1 = "Show Nr.:"
            Cells(m + 10, n + 3).FormulaR1C1 = "0"
            Cells(m + 10, n + 4).FormulaR1C1 = "Sigma (shielding.) , Z_eff:"
            Cells(m + 10, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 10, n + 22).FormulaR1C1 = "Press the Duplicate Atom button."
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 2).FormulaR1C1 = "Show radius:"
            Cells(m + 11, n + 3).FormulaR1C1 = "0"
            Cells(m + 11, n + 4).FormulaR1C1 = "= (R[-9]C[-1]-1)*0.3"
            Cells(m + 11, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 11, n + 6).FormulaR1C1 = "d-f "
            Cells(m + 11, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 11, n + 22).FormulaR1C1 = "Scroll down the page until you find the configuration of the duplicate atom."
            Cells(m + 3, n + 1).Interior.Color = "255"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 27 Then ' vector 4
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(R31C5=0,"""",R[10]C[3] & ""  ("" & ADDRESS(ROW(R[1]C[3]),COLUMN(R[1]C[3]),4) & "")"")"
            Cells(m + 3, n + 1).FormulaR1C1 = "=-1.6E-19"
            Cells(m + 3, n + 4).FormulaR1C1 = "=0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1)"
            Cells(m + 3, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 3, n + 6).FormulaR1C1 = "" & ChrW(8675) & ""
            Cells(m + 3, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 3, n + 22).FormulaR1C1 = "Edit its position in space at x,y,z coordinates"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=IF(R32C5=0,9,183)"
            Cells(m + 4, n + 2).FormulaR1C1 = "phi ="
            Cells(m + 4, n + 3).FormulaR1C1 = "=R23C23+(R23C25-R23C23)/R[8]C*R[9]C+R20C4"
            Cells(m + 4, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 4, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 4, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 4, n + 21).FormulaR1C1 = "3. Removing an Atom:"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=R32C5"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "theta ="
            Cells(m + 5, n + 3).FormulaR1C1 = "=R24C23+(R24C25-R24C23)/R[7]C*R[8]C+R20C5"
            Cells(m + 5, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 5, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 5, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 5, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 5, n + 22).FormulaR1C1 = "Press the X button on the atom to be removed."
            Cells(m + 6, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 6, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 6, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 6, n + 21).FormulaR1C1 = "4. Calculating the Electric Field at a Point in Space:"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C[4]*COS(RADIANS(R[-3]C[4]))*SIN(RADIANS(R[-2]C[4]))+R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C[3]*SIN(RADIANS(R[-3]C[3]))*SIN(RADIANS(R[-2]C[3]))+R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C[2]*COS(RADIANS(R[-2]C[2]))+R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Electron Nr."
            Cells(m + 7, n + 3).FormulaR1C1 = "=R[-18]C+1"
            Cells(m + 7, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 7, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 7, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 7, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 7, n + 22).FormulaR1C1 = "Select 1 in the L8 list and enter the coordinates of the point in A11,B11,C11. Press " & ChrW(8629) & " Field"
            Cells(m + 8, n + 2).FormulaR1C1 = "=IF(R[-1]C[1]<=R23C5,R23C6,IF(R[-1]C[1]<=R24C5+R23C5,R24C6,IF(R[-1]C[1]<=R25C5+R24C5+R23C5,R25C6,IF(R[-1]C[1]<=R26C5+R25C5+R24C5+R23C5,R26C6,IF(R[-1]C[1]<=R27C5+R26C5+R25C5+R24C5+R23C5,R27C6,IF(R[-1]C[1]<=R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R28C6,IF(R[-1]C[1]<=R29C5+R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R29C6,R22C6)))))))"
            Cells(m + 8, n + 3).FormulaR1C1 = "=VLOOKUP(RC[-1],R22C6:R29C7,2,FALSE)"
            Cells(m + 8, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 8, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 8, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 8, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 8, n + 22).FormulaR1C1 = "The components of the field are observed at A12 for Ex, B12 for Ey, C12 for Ez."
            Cells(m + 9, n + -1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C1-R[-2]C)"
            Cells(m + 9, n + 0).FormulaR1C1 = "=IF(R32C5=0,"""",R19C2-R[-2]C)"
            Cells(m + 9, n + 1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C3-R[-2]C)"
            Cells(m + 9, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 9, n + 22).FormulaR1C1 = "The magnitude of the resulting electric field of all atoms is observed in G9."
            Cells(m + 10, n + -1).FormulaR1C1 = "=IF(R32C5=0,1,6)"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 4).FormulaR1C1 = "Ref. in P. Table:"
            Cells(m + 10, n + 21).FormulaR1C1 = "            d)"
            Cells(m + 10, n + 22).FormulaR1C1 = "The electric field of the first nucleus is observed in row 30, of the first electron in"
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "=IF(R32C5=0,8,2)"
            Cells(m + 11, n + 4).FormulaR1C1 = "=FIND(""|"" & R16C7 & "","",  R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22 )"
            Cells(m + 11, n + 22).FormulaR1C1 = " row 48, and so on for the other electrons. The row of nuclei is labeled E_0 (see D30)."
            Cells(m + 3, n + 1).Interior.Color = "15773696"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 36 Then ' vector 3
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "=""Tot. in ""&R[-4]C"
            Cells(m + 3, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-4]C[-1])"
            Cells(m + 3, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 3, n + 21).FormulaR1C1 = "5. Calculating the Electric Field at a Region in Space:"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "Charge Nr:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=COUNTIF(R15C4:R[-4]C[-1],R[-5]C[-1])"
            Cells(m + 4, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 4, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 4, n + 22).FormulaR1C1 = "Select 2, 3, 4, or 5 from the list in L8 and press " & ChrW(8629) & " Field. Set the display area to the "
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 5, n + 22).FormulaR1C1 = "corresponding cells in columns Y, Z, AA, AB, and AC, rows 12 through 17."
            Cells(m + 6, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 6, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 6, n + 22).FormulaR1C1 = "To extract a data table with all the points in the space, select YES in R8."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 7, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 7, n + 22).FormulaR1C1 = "To visually adjust the size of the vectors, set the values in cells F8 and G8 by trial and "
            Cells(m + 8, n + -1).FormulaR1C1 = "1"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 8, n + 22).FormulaR1C1 = "error (values range from decimals to large powers)."
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 9, n + 21).FormulaR1C1 = "6. Units:"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 10, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 10, n + 22).FormulaR1C1 = "Enter Z10 = 1 to work in Angstrom and Z10 = 1E-10 to work in meters."
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 11, n + 20).FormulaR1C1 = "                ______________________________________________________________________________________"
            Cells(m + 3, n + 1).Interior.Color = "49407"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 45 Then ' vector 2
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(R31C5=0,"""",R[10]C[3] & ""  ("" & ADDRESS(ROW(R[1]C[3]),COLUMN(R[1]C[3]),4) & "")"")"
            Cells(m + 3, n + 1).FormulaR1C1 = "=-1.6E-19"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=IF(R32C5=0,9,183)"
            Cells(m + 4, n + 2).FormulaR1C1 = "phi ="
            Cells(m + 4, n + 3).FormulaR1C1 = "=R23C23+(R23C25-R23C23)/R[8]C*R[9]C+R20C4"
            Cells(m + 4, n + 21).FormulaR1C1 = "Remarks:"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=R32C5"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "theta ="
            Cells(m + 5, n + 3).FormulaR1C1 = "=R24C23+(R24C25-R24C23)/R[7]C*R[8]C+R20C5"
            Cells(m + 5, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 5, n + 22).FormulaR1C1 = "Electron radii are automatically calculated for each individual atom using the Bohr"
            Cells(m + 6, n + 22).FormulaR1C1 = "model and Slater's screening rules (which provide good approximations for small atoms)."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C[4]*COS(RADIANS(R[-3]C[4]))*SIN(RADIANS(R[-2]C[4]))+R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C[3]*SIN(RADIANS(R[-3]C[3]))*SIN(RADIANS(R[-2]C[3]))+R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C[2]*COS(RADIANS(R[-2]C[2]))+R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Electron Nr."
            Cells(m + 7, n + 3).FormulaR1C1 = "=R[-18]C+1"
            Cells(m + 7, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 7, n + 22).FormulaR1C1 = "The electric field for the atom or atoms is automatically calculated at each point"
            Cells(m + 8, n + 2).FormulaR1C1 = "=IF(R[-1]C[1]<=R23C5,R23C6,IF(R[-1]C[1]<=R24C5+R23C5,R24C6,IF(R[-1]C[1]<=R25C5+R24C5+R23C5,R25C6,IF(R[-1]C[1]<=R26C5+R25C5+R24C5+R23C5,R26C6,IF(R[-1]C[1]<=R27C5+R26C5+R25C5+R24C5+R23C5,R27C6,IF(R[-1]C[1]<=R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R28C6,IF(R[-1]C[1]<=R29C5+R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R29C6,R22C6)))))))"
            Cells(m + 8, n + 3).FormulaR1C1 = "=VLOOKUP(RC[-1],R22C6:R29C7,2,FALSE)"
            Cells(m + 8, n + 22).FormulaR1C1 = "in space using the classical formula of Coulomb's law for electrons and protons,"
            Cells(m + 9, n + -1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C1-R[-2]C)"
            Cells(m + 9, n + 0).FormulaR1C1 = "=IF(R32C5=0,"""",R19C2-R[-2]C)"
            Cells(m + 9, n + 1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C3-R[-2]C)"
            Cells(m + 9, n + 22).FormulaR1C1 = "which do not interact with each other and are considered point charges. Quantum"
            Cells(m + 10, n + -1).FormulaR1C1 = "=IF(R32C5=0,1,6)"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 22).FormulaR1C1 = "mechanics is used only to calculate the radii."
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "=IF(R32C5=0,8,2)"
            Cells(m + 11, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 11, n + 22).FormulaR1C1 = "Quantum effects are not taken into account when calculating the field and the "
            Cells(m + 3, n + 1).Interior.Color = "15773696"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 54 Then ' vector 1
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "=""Tot. in ""&R[-4]C"
            Cells(m + 3, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-4]C[-1])"
            Cells(m + 3, n + 22).FormulaR1C1 = "positions of the electrons."
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "Charge Nr:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=COUNTIF(R15C4:R[-4]C[-1],R[-5]C[-1])"
            Cells(m + 4, n + 21).FormulaR1C1 = "            d)"
            Cells(m + 4, n + 22).FormulaR1C1 = "Initially, the spatial distribution of electrons is done in the YZ plane, but the"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 22).FormulaR1C1 = "distribution space can be customized in spherical coordinates using the azimuthal"
            Cells(m + 6, n + 22).FormulaR1C1 = "angles in cells W23 and Y23, and the polar angles in cells W24 and Y24."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 21).FormulaR1C1 = "            e)"
            Cells(m + 7, n + 22).FormulaR1C1 = "The distribution of electrons in the atom is based only on the first atomic number"
            Cells(m + 8, n + -1).FormulaR1C1 = "1"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 22).FormulaR1C1 = "n according to the periodic table and is observed from cell E23 for the first atom,"
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 22).FormulaR1C1 = "and in the corresponding cells for the other atoms."
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 21).FormulaR1C1 = "            f)"
            Cells(m + 10, n + 22).FormulaR1C1 = "To EXPORT a project press the Code button."
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 3, n + 1).Interior.Color = "49407"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Cells(m1 + 2, n1 - 1).Value = 7
      End If ' vector ends
      If m = m1 + 54 Then
            Cells(m + 12, n + 20).FormulaR1C1 = "                ______________________________________________________________________________________"
       Call BlackWhiteDesk
       Call PutEqBut
      End If ' actualizar hoja
End Sub
Sub Project_3_ES(ByVal VecType, m, n, m1, n1 As Integer) ' 46_Elementos en P Table _ES

'   Updated: 27/08/25
'   Created by: Ariel R. Becerra, Alvaro Herrera, Martha Molina(21/05/25)
'   Modified by: _________________
'   This file contains the code for your new ScienSolar project.
'   ==============================================================================
'   PROJECT CODE: 3
'
'   INTEGRATION INSTRUCTIONS:
'   Note 1: The project number (46) in the function name must match the entry in the CONFIG sheet project list. Update if necessary.
'   Note 2: This code will be integrated into the main VBA project to automate  project loading and execution.
'   Note 3: Generated formulas and values are limited to the first 30 columns.  Keep all project data within this range for optimal performance.
'
'   STEP-BY-STEP INTEGRATION: ==================
'    1. CONFIG Sheet Setup (for new projects):
'                                      - Navigate to the CONFIG sheet and add a consecutive number to the last row of the projects list (column C, from row 35)
'                                      - Add a descriptive project name in the corresponding language column
'                                      - Replace (if it doesn't match) the number in Sub Project_3 with the new number from the list
'    2. Numbering Validation:
'                                      - Ensure projects in the CONFIG sheet maintain ascending numerical order
'                                      - Only integers are allowed
'    3. VBA Editor Preparation:
'                                      - Open VBA Editor (Alt+F11 Windows / Fn+Option+F11 macOS)
'                                      - Close other workbooks to avoid accidental code placement
'                                      - In the Project Explorer, select an existing module with available space
'                                      - Alternatively, insert a new module (Insert -- > Module)
'    5. Code Implementation:
'                                      - Select all code in this file and copy it
'                                      - Paste at the end of the selected module's code (for new projects)
'                                      - Replace de old code with the new one (for existing projects). Verify the code
'    6. Project Testing:
'                                      - Return to the CONFIG sheet and click 'New Sheet'
'                                      - Select your project from the list and click '+Vector'
'                                      - Large projects require repeated '+Vector' button presses when loading.
'                                      - Verify successful loading in the new sheet
'   SUPPORT AND UPDATES: =====================
'    Visit www.sciensolar.com for latest updates and documentation
'    © ScienSolar - Advanced Solar Project Management
'   ==============================================================================
'
            Cells(m1 - 1, n1 + 2).FormulaR1C1 = "1"
            Cells(m1 - 1, n1).Value = "0"
            Cells(m1 + 0, n1 + 0).FormulaR1C1 = "=IF(R[-1]C=""ENTIRE"",15,33)"
            Cells(m1 + 0, n1 + 1).FormulaR1C1 = "50"
            Cells(m1 + 0, n1 + 2).FormulaR1C1 = "=CONFIG!R3C4"
            Cells(m1 + 0, n1 + 3).FormulaR1C1 = "800"
            Cells(m1 + 0, n1 + 6).FormulaR1C1 = "=CONFIG!R3C8"
            Cells(m1 + 0, n1 + 7).FormulaR1C1 = "8"
            Cells(m1 + 0, n1 + 8).FormulaR1C1 = "Ariel R. Becerra (21/11/23)"
            Cells(m1 + 1, n1 + 2).FormulaR1C1 = "=CONFIG!R4C4"
            Cells(m1 + 1, n1 + 3).FormulaR1C1 = "480"
            Cells(m1 + 1, n1 + 4).FormulaR1C1 = "=CONFIG!R4C6"
            Cells(m1 + 1, n1 + 5).FormulaR1C1 = "0"
            Cells(m1 + 1, n1 + 6).FormulaR1C1 = "=CONFIG!R4C8"
            Cells(m1 + 1, n1 + 7).FormulaR1C1 = "45"
            Cells(m1 + 2, n1 + 0).FormulaR1C1 = "t = 0,2460938 s."
            Cells(m1 + 2, n1 + 2).FormulaR1C1 = "=CONFIG!R5C4"
            Cells(m1 + 2, n1 + 3).FormulaR1C1 = "=100/R[5]C[21]"
            Cells(m1 + 2, n1 + 4).FormulaR1C1 = "=CONFIG!R5C6"
            Cells(m1 + 2, n1 + 5).FormulaR1C1 = "15"
            Cells(m1 + 2, n1 + 6).FormulaR1C1 = "=CONFIG!R5C8"
            Cells(m1 + 2, n1 + 7).FormulaR1C1 = "0"
            Cells(m1 + 3, n1 + 0).FormulaR1C1 = "E"
            Cells(m1 + 3, n1 + 1).FormulaR1C1 = "15"
            Cells(m1 + 3, n1 + 2).FormulaR1C1 = "=CONFIG!R6C4"
            Cells(m1 + 3, n1 + 3).FormulaR1C1 = "200"
            Cells(m1 + 3, n1 + 4).FormulaR1C1 = "=CONFIG!R6C6"
            Cells(m1 + 3, n1 + 5).FormulaR1C1 = "15"
       Cells(m1, n1 + 9).FormulaR1C1 = "HELP"
       Dim HELPtxt As String
       HELPtxt = "   CAMPO EL" & ChrW(201) & "CTROST" & ChrW(193) & "TICO DE LOS ELEMENTOS DE LA TABLA PERI" & ChrW(211) & "DICA." & Chr(10) & "" & Chr(10) & "    El modelo calcula el campo el" & ChrW(233) & "ctrico de los " & ChrW(225) & "tomos de la tabla peri" & ChrW(243) & "dica dentro y fuera de ellos a partir de la f" & ChrW(237) & "sica cl" & ChrW(225) & "sica y sin tener en cuenta la interacci" & ChrW(243) & "n entre electrones ni electrones con protones. Los radios se calculan a partir de las reglas de Stepler para la mec" & ChrW(225) & "nica cu" & ChrW(225) & "ntica. S" & ChrW(243) & "lo se tiene en cuanta el n" & ChrW(250) & "mero cu" & ChrW(225) & "ntico principal n. " & Chr(10) & _
"     " & Chr(10) & "    CONFIGURACI" & ChrW(211) & "N DE CELDAS:" & Chr(10) & "" & Chr(10) & "A11 = inserte la coordenada x" & Chr(10) & "B11 = inserte la coordenada y" & Chr(10) & "C11 = inserte la coordenada z" & Chr(10) & _
"     " & Chr(10) & "G18 = posici" & ChrW(243) & "n del primer " & ChrW(225) & "tomo en la coordenada x " & Chr(10) & "G19 = posici" & ChrW(243) & "n del primer " & ChrW(225) & "tomo en la coordenada y" & Chr(10) & "G20 = posici" & ChrW(243) & "n del primer " & ChrW(225) & "tomo en la coordenada z" & Chr(10) & _
"     (para los dem" & ChrW(225) & "s " & ChrW(225) & "tomos en las celdas similares en la parte inferior de la hoja, deslizar hacia abajo)" & Chr(10) & "" & Chr(10) & "    Resultado del campo en un punto:" & Chr(10) & _
"     A12 = E_x.  ;  B12 = E_y.  ;  C12 = E_z.  ;   G10 = E" & Chr(10) & "    Campo del primer n" & ChrW(250) & "cleo: A30, B30, C30." & Chr(10) & "    Campo del primer electr" & ChrW(243) & "n: A48, B48, C48." & Chr(10) & _
"         De manera similar  con los dem" & ChrW(225) & "s n" & ChrW(250) & "cleos y electrones."
       On Error Resume Next
       Cells(m1, n1 + 9).Comment.text text:=HELPtxt

      ' C—digo para recrear controles
       Dim ws As Worksheet
       Set ws = ThisWorkbook.ActiveSheet

       If m = 3 Then
           PatronW = ActiveSheet.Cells(1, 1).Width
           PatronH = ActiveSheet.Cells(1, 1).Height

             ' ComboBox
             Set dd = ws.DropDowns.Add(Left:=Range("D15").Left + Range("$D$15").Width * 0, Top:=Range("$D$15").Top, Width:=Range("$D$15").Width * 2, Height:=Range("$D$15").Height * 1)
             With dd
                 .Placement = 2
                 .name = "Elements15"
                 .LinkedCell = "$G$16"
                 .AddItem "1  Hidr" & ChrW(243) & "geno"
                 .AddItem "2  Helio"
                 .AddItem "3  Litio"
                 .AddItem "4  Berilio"
                 .AddItem "5  Boro"
                 .AddItem "6  Carbono"
                 .AddItem "7  Nitr" & ChrW(243) & "geno"
                 .AddItem "8  Ox" & ChrW(237) & "geno"
                 .AddItem "9  Fl" & ChrW(250) & "or"
                 .AddItem "10  Ne" & ChrW(243) & "n"
                 .AddItem "11  Sodio"
                 .AddItem "12  Magnesio"
                 .AddItem "13  Aluminio"
                 .AddItem "14  Silicio"
                 .AddItem "15  F" & ChrW(243) & "sforo"
                 .AddItem "16  Azufre"
                 .AddItem "17  Cloro"
                 .AddItem "18  Arg" & ChrW(243) & "n"
                 .AddItem "19  Potasio"
                 .AddItem "20  Calcio"
                 .AddItem "21  Escandio"
                 .AddItem "22  Titanio"
                 .AddItem "23  Vanadio"
                 .AddItem "24  Cromo"
                 .AddItem "25  Manganeso"
                 .AddItem "26  Hierro"
                 .AddItem "27  Cobalto"
                 .AddItem "28  N" & ChrW(237) & "quel"
                 .AddItem "29  Cobre"
                 .AddItem "30  Zinc"
                 .AddItem "31  Galio"
                 .AddItem "32  Germanio"
                 .AddItem "33  Ars" & ChrW(233) & "nico"
                 .AddItem "34  Selenio"
                 .AddItem "35  Bromo"
                 .AddItem "36  Kript" & ChrW(243) & "n"
                 .AddItem "37  Rubidio"
                 .AddItem "38  Estroncio"
                 .AddItem "39  Itrio"
                 .AddItem "40  Circonio"
                 .AddItem "41  Niobio"
                 .AddItem "42  Molibdeno"
                 .AddItem "43  Tecnecio"
                 .AddItem "44  Rutenio"
                 .AddItem "45  Rodio"
                 .AddItem "46  Paladio"
                 .AddItem "47  Plata"
                 .AddItem "48  Cadmio"
                 .AddItem "49  Indio"
                 .AddItem "50  Esta" & ChrW(241) & "o"
                 .AddItem "51  Antimonio"
                 .AddItem "52  Telurio"
                 .AddItem "53  Yodo"
                 .AddItem "54  Xen" & ChrW(243) & "n"
                 .AddItem "55  Cesio"
                 .AddItem "56  Bario"
                 .AddItem "57  Lantano"
                 .AddItem "58  Cerio"
                 .AddItem "59  Praseodimio"
                 .AddItem "60  Neodimio"
                 .AddItem "61  Promecio"
                 .AddItem "62  Samario"
                 .AddItem "63  Europio"
                 .AddItem "64  Gadolinio"
                 .AddItem "65  Terbio"
                 .AddItem "66  Disprosio"
                 .AddItem "67  Holmio"
                 .AddItem "68  Erbio"
                 .AddItem "69  Tulio"
                 .AddItem "70  Iterbio"
                 .AddItem "71  Lutecio"
                 .AddItem "72  Hafnio"
                 .AddItem "73  Tantalio"
                 .AddItem "74  Wolframio"
                 .AddItem "75  Renio"
                 .AddItem "76  Osmio"
                 .AddItem "77  Iridio"
                 .AddItem "78  Platino"
                 .AddItem "79  Oro"
                 .AddItem "80  Mercurio"
                 .AddItem "81  Talio"
                 .AddItem "82  Plomo"
                 .AddItem "83  Bismuto"
                 .AddItem "84  Polonio"
                 .AddItem "85  Astato"
                 .AddItem "86  Rad" & ChrW(243) & "n"
                 .AddItem "87  Francio"
                 .AddItem "88  Radio"
                 .AddItem "89  Actinio"
                 .AddItem "90  Torio"
                 .AddItem "91  Protactinio"
                 .AddItem "92  Uranio"
                 .AddItem "93  Neptunio"
                 .AddItem "94  Plutonio"
                 .AddItem "95  Americio"
                 .AddItem "96  Curio"
                 .AddItem "97  Berkelio"
                 .AddItem "98  Californio"
                 .AddItem "99  Einstenio"
                 .AddItem "100  Fermio"
                 .AddItem "101  Mendelevio"
                 .AddItem "102  Nobelio"
                 .AddItem "103  Lawrencio"
                 .AddItem "104  Rutherfordio"
                 .AddItem "105  Dubnio"
                 .AddItem "106  Seaborgio"
                 .AddItem "107  Bohrio"
                 .AddItem "108  Hassio"
                 .AddItem "109  Meitnerio"
                 .AddItem "110  Darmstadtio"
                 .AddItem "111  Roentgenio"
                 .AddItem "112  Copernicio"
                 .AddItem "113  Nihonio"
                 .AddItem "114  Flerovio"
                 .AddItem "115  Moscovio"
                 .AddItem "116  Livermorio"
                 .AddItem "117  Tennessino"
                 .AddItem "118  Oganes" & ChrW(243) & "n"
                 .ListFillRange = ""
                 .Value = 2
                 .Display3DShading = True
             End With
             Set dd = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("F15").Left + Range("$F$15").Width * 0, Top:=Range("$F$15").Top, Width:=Range("$F$15").Width * 1, Height:=Range("$F$15").Height * 1).Select
             With Selection
               .name = "AddButt(15)[68](33)[50]1PT"
               .OnAction = "PTableRefresh"
               .text = "Actualizar"
             End With

             ' ComboBox
             Set dd = ws.DropDowns.Add(Left:=Range("L8").Left + Range("$L$8").Width * 0, Top:=Range("$L$8").Top, Width:=Range("$L$8").Width * 3.5, Height:=Range("$L$8").Height * 1)
             With dd
                 .Placement = 2
                 .name = "ViewType"
                 .LinkedCell = "$AB$19"
                 .AddItem "1. En un punto del espacio"
                 .AddItem "2: En coord. Cartesianas (editable)"
                 .AddItem "3: En coord. Cartesianas (denso)"
                 .AddItem "4. En coord. cil" & ChrW(237) & "ndricas"
                 .AddItem "5. En coord. esf" & ChrW(233) & "ricas"
                 .ListFillRange = "$AB$20:$AB$24"
                 .Value = 1
                 .Display3DShading = True
             End With
             Set dd = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("O8").Left + Range("$O$8").Width * 0.5, Top:=Range("$O$8").Top, Width:=Range("$O$8").Width * 1, Height:=Range("$O$8").Height * 1).Select
             With Selection
               .name = "FieldButton"
               .OnAction = "Rotate"
               .text = "" & ChrW(8629) & "  Campo"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("G15").Left + Range("$G$15").Width * 0, Top:=Range("$G$15").Top, Width:=Range("$G$15").Width * 1.5, Height:=Range("$G$15").Height * 1).Select
             With Selection
               .name = "AddButt(15)[68](33)[50]2PT"
               .OnAction = "PTableDuplicateAtom"
               .text = "Duplicar " & ChrW(225) & "tomo"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("H15").Left + Range("$H$15").Width * 0.5, Top:=Range("$H$15").Top, Width:=Range("$H$15").Width * 0.5, Height:=Range("$H$15").Height * 1).Select
             With Selection
               .name = "DelButt(15)[68](33)[50]3PT"
               .OnAction = "PTableDuplicateAtom"
               .text = "X"
             End With

             ' Opton button
             Set opt = ws.OptionButtons.Add(Left:=Range("R8").Left + Range("$R$8").Width * 0, Top:=Range("$R$8").Top, Width:=Range("$R$8").Width * 0.5, Height:=Range("$R$8").Height * 1.5)
             opt.Caption = ""
             With opt
              .name = "YesOptionButt"
              .LinkedCell = "$T$8"
             End With
             Set opt = Nothing

             ' Opton button
             Set opt = ws.OptionButtons.Add(Left:=Range("S8").Left + Range("$S$8").Width * 0, Top:=Range("$S$8").Top, Width:=Range("$S$8").Width * 0.5, Height:=Range("$S$8").Height * 1.5)
             opt.Caption = ""
             With opt
              .name = "NoOptionButt"
              .LinkedCell = "$T$8"
             End With
             Set opt = Nothing

             ' Button
             ws.Buttons.Add(Left:=Range("T8").Left + Range("$T$8").Width * 0, Top:=Range("$T$8").Top, Width:=Range("$T$8").Width * 1, Height:=Range("$T$8").Height * 1).Select
             With Selection
               .name = "DelTableButt"
               .OnAction = "PTCleanTable"
               .text = "Borrar datos"
             End With

             ' Button
             ws.Buttons.Add(Left:=Range("H8").Left + Range("$H$8").Width * 0, Top:=Range("$H$8").Top, Width:=Range("$H$8").Width * 1.5, Height:=Range("$H$8").Height * 1).Select
             With Selection
               .name = "RotElecButt"
               .OnAction = "PTRotateElectrons"
               .text = " " & ChrW(8634) & "  Electrones  " & ChrW(8630) & ""
             End With

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("F8").Left + Range("$F$8").Width * 0, Top:=Range("$F$8").Top, Width:=Range("$F$8").Width * 0.5, Height:=Range("$F$8").Height * 1)
             spin.name = "SpinnerB8L"
             spin.LinkedCell = "$F$8"
             spin.Min = 20
             spin.max = 30000
             spin.Value = 30
             spin.SmallChange = 2
             spin.Value = 30
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("G8").Left + Range("$G$8").Width * 0, Top:=Range("$G$8").Top, Width:=Range("$G$8").Width * 0.5, Height:=Range("$G$8").Height * 1)
             spin.name = "SpinnerB8R"
             spin.LinkedCell = "$G$8"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 1
             spin.SmallChange = 1
             spin.Value = 1
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("E19").Left + Range("$E$19").Width * 0.5, Top:=Range("$E$19").Top, Width:=Range("$E$19").Width * 0.5, Height:=Range("$E$19").Height * 1)
             spin.name = "Spinner 937"
             spin.LinkedCell = "$E$20"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 0
             spin.SmallChange = 1
             spin.Value = 0
             spin.OnAction = "Rotate"
             Set spin = Nothing

             ' SpinButton
             Set spin = ws.Spinners.Add(Left:=Range("E19").Left + Range("$E$19").Width * 0, Top:=Range("$E$19").Top, Width:=Range("$E$19").Width * 0.5, Height:=Range("$E$19").Height * 1)
             spin.name = "Spinner 938"
             spin.LinkedCell = "$D$20"
             spin.Min = 0
             spin.max = 30000
             spin.Value = 0
             spin.SmallChange = 1
             spin.Value = 0
             spin.OnAction = "Rotate"
             Set spin = Nothing

       End If

          Dim p As Integer
          For p = 1 To 0
          If Range("A5").Value = "Next sub_i" Then Exit Sub
                 Application.Run "Project_46_" & p & "_ES", VecType, m, n, m1, n1 '
          Next p

      If m = m1 + 0 Then ' vector 7
            Cells(m + 3, n + -1).FormulaR1C1 = "1"
            Cells(m + 3, n + 0).FormulaR1C1 = "E"
            Cells(m + 3, n + 1).FormulaR1C1 = "15"
            Cells(m + 3, n + 2).FormulaR1C1 = "=CONFIG!R6C4"
            Cells(m + 3, n + 3).FormulaR1C1 = "200"
            Cells(m + 3, n + 4).FormulaR1C1 = "=CONFIG!R6C6"
            Cells(m + 3, n + 5).FormulaR1C1 = "15"
            Cells(m + 3, n + 9).FormulaR1C1 = "Vectors visually modified (magnitude unchanged). Adjust scale in  B8"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 1).FormulaR1C1 = "=IF(R[12]C[25]=1,"""",IF(R[12]C[25]=2,R[14]C[24],IF(R[12]C[25]=3,R[15]C[24],IF(R[12]C[25]=4,R[16]C[24],IF(R[12]C[25]=5,R[17]C[24])))))"
            Cells(m + 4, n + 2).FormulaR1C1 = "Campo el" & ChrW(233) & "crico de " & ChrW(225) & "tomos. "
            Cells(m + 4, n + 12).FormulaR1C1 = "CAMPO ELECTROST" & ChrW(193) & "TICO COULOMBIANO DE " & ChrW(193) & "TOMOS Y SU COMBINACI" & ChrW(211) & "N"
            Cells(m + 4, n + 24).FormulaR1C1 = "CONFIGURACI" & ChrW(211) & "N E INSTRUCCIONES"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=IF(R[2]C[24]=1,RC[4] &""*""&RC[5],RC[4] &""*""&RC[5] &""E+20"")"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "Regular tama" & ChrW(241) & "o vector:"
            Cells(m + 5, n + 4).FormulaR1C1 = "30"
            Cells(m + 5, n + 5).FormulaR1C1 = "1"
            Cells(m + 5, n + 8).FormulaR1C1 = "Vista del campo:"
            Cells(m + 5, n + 15).FormulaR1C1 = "Datos:"
            Cells(m + 5, n + 16).FormulaR1C1 = "SI"
            Cells(m + 5, n + 17).FormulaR1C1 = "NO"
            Cells(m + 5, n + 18).FormulaR1C1 = "2"
            Cells(m + 6, n + -1).FormulaR1C1 = "=SUMIFS(C[2],C[3],""E_*"")"
            Cells(m + 6, n + 0).FormulaR1C1 = "=SUMIFS(C[-1],C[2],""E_*"")"
            Cells(m + 6, n + 1).FormulaR1C1 = "=SUMIFS(C[-1],C[1],""E_*"")"
            Cells(m + 6, n + 2).FormulaR1C1 = "Total cargas:"
            Cells(m + 6, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],""E_*"")"
            Cells(m + 6, n + 4).FormulaR1C1 = "=""  E  "" & IF(R[1]C[20]=1,""(V/" & ChrW(197) & ")"",""(V/m)"")&"" ="""
            Cells(m + 6, n + 5).FormulaR1C1 = "=SQRT(R[3]C[-6]^2+R[3]C[-5]^2+R[3]C[-4]^2)"
            Cells(m + 6, n + 6).FormulaR1C1 = "=IF(R[10]C[20]=1,""   Editar el punto de observaci" & ChrW(243) & "n en A11, B11, C11)"",IF(R[10]C[20]=2,""       Editar los par" & ChrW(225) & "metros en CONFIGURACI" & ChrW(211) & "N (celdas Y12 -AC14)  -- >> "",IF(R[10]C[20]=3,""       Editar los par" & ChrW(225) & "metros en CONFIGURACI" & ChrW(211) & "N (celda   AA22)  -- >>. "",IF(R[10]C[20]=4,""       Editar los par" & ChrW(225) & "metros en CONFIGURACI" & ChrW(211) & "N (celdas Y14 - AA16)  --- >> "",IF(R[10]C[20]=5,""       Editar los par" & ChrW(225) & "metros en CONFIGURACI" & ChrW(211) & "N  (celdas Y15 - AA17)   -- >> "","""")))))"
            Cells(m + 6, n + 14).FormulaR1C1 = "=IF(R[-1]C[4]=1,""       Los datos se extraen en una tabla a partir de la fila 46."","""")"
            Cells(m + 6, n + 20).FormulaR1C1 = "////////////////////////////////////////////////// CONFIGURACI" & ChrW(211) & "N ///////////////////////////////////////////////"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C"
            Cells(m + 7, n + 2).FormulaR1C1 = "Tot. " & ChrW(225) & "tomos:"
            Cells(m + 7, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],""E_0"")"
            Cells(m + 7, n + 4).FormulaR1C1 = "            k    ="
            Cells(m + 7, n + 5).FormulaR1C1 = "=IF(RC[19]=1,0.89875517923*(100000000000000000000),0.89875517923/RC[19])"
            Cells(m + 7, n + 20).FormulaR1C1 = "___________________________________"
            Cells(m + 7, n + 23).FormulaR1C1 = "        1 " & ChrW(197) & " ="
            Cells(m + 7, n + 24).FormulaR1C1 = "1"
            Cells(m + 7, n + 25).FormulaR1C1 = "       _______________________________"
            Cells(m + 8, n + -1).FormulaR1C1 = "0"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 2).FormulaR1C1 = "=""<< --- Ingrese (x, y, z)  "" & IF(R[-1]C[22]=1,""(en Angstrom " & ChrW(197) & ")"",""(en metros)"")"
            Cells(m + 8, n + 20).FormulaR1C1 = "TABLA"
            Cells(m + 8, n + 21).FormulaR1C1 = "|  PAR" & ChrW(193) & "METROS DE VISUALIZACI" & ChrW(211) & "N DEL CAMPO:"
            Cells(m + 8, n + 25).FormulaR1C1 = "     Paso:"
            Cells(m + 8, n + 26).FormulaR1C1 = "|      Desplazar coordenadas:"
            Cells(m + 9, n + -1).FormulaR1C1 = "=R[-3]C[1]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=R[-3]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=R[-3]C[-2]"
            Cells(m + 9, n + 20).FormulaR1C1 = "PERI" & ChrW(211) & "DICA:"
            Cells(m + 9, n + 21).FormulaR1C1 = "|"
            Cells(m + 9, n + 22).FormulaR1C1 = "X_in -X_fin ="
            Cells(m + 9, n + 23).FormulaR1C1 = "=0*R[-2]C[1]"
            Cells(m + 9, n + 24).FormulaR1C1 = "=0*R[-2]C"
            Cells(m + 9, n + 25).FormulaR1C1 = "=0.2*R[-2]C[-1]"
            Cells(m + 9, n + 26).FormulaR1C1 = "|      en x:"
            Cells(m + 9, n + 27).FormulaR1C1 = "0"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "=IF(R[-5]C[18]=1,50,0)"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 20).FormulaR1C1 = "Hidr" & ChrW(243) & "geno,Helio,Litio,Berilio,Boro,Carbono,Nitr" & ChrW(243) & "geno,Ox" & ChrW(237) & "geno,Fl" & ChrW(250) & "or,Ne" & ChrW(243) & "n,Sodio,Magnesio,Aluminio,Silicio,F" & ChrW(243) & "sforo,Azufre,Cloro,Arg" & ChrW(243) & "n,Potasio,Calcio,Escandio,Titanio,Vanadio,Cromo,Manganeso,Hierro,Cobalto,N" & ChrW(237) & "quel,Cobre,Zinc,Galio,Germanio,Ars" & ChrW(233) & "nico,Selenio,Bromo,Kript" & ChrW(243) & "n,Rubidio,Estroncio,Itrio,Circonio,Niobio,Molibdeno,Tecnecio,Rutenio,Rodio,Paladio,Plata,Cadmio,Indio,Esta" & ChrW(241) & "o,Antimonio,Telurio,Yodo,Xen" & ChrW(243) & "n,Cesio,Bario,Lantano,Cerio,Praseodimio,Neodimio,Promecio,"
            Cells(m + 10, n + 21).FormulaR1C1 = "|"
            Cells(m + 10, n + 22).FormulaR1C1 = "Y_in -Y_fin ="
            Cells(m + 10, n + 23).FormulaR1C1 = "=-3*R[-3]C[1]"
            Cells(m + 10, n + 24).FormulaR1C1 = "=3*R[-3]C"
            Cells(m + 10, n + 25).FormulaR1C1 = "=0.3*R[-3]C[-1]"
            Cells(m + 10, n + 26).FormulaR1C1 = "|      en y:"
            Cells(m + 10, n + 27).FormulaR1C1 = "=1*R[-3]C[-3]"
            Cells(m + 11, n + -1).FormulaR1C1 = "4"
            Cells(m + 11, n + 0).FormulaR1C1 = "=IF(R[-6]C[18]=1,10,0)"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 20).FormulaR1C1 = "Samario,Europio,Gadolinio,Terbio,Disprosio,Holmio,Erbio,Tulio,Iterbio,Lutecio,Hafnio,Tantalio,Wolframio,Renio,Osmio,Iridio,Platino,Oro,Mercurio,Talio,Plomo,Bismuto,Polonio,Astato,Rad" & ChrW(243) & "n,Francio,Radio,Actinio,Torio,Protactinio,Uranio,Neptunio,Plutonio,Americio,Curio,Berkelio,Californio,Einstenio,Fermio,Mendelevio,Nobelio,Lawrencio,Rutherfordio,Dubnio,Seaborgio,Bohrio,Hassio,Meitnerio,Darmstadtio,Roentgenio,Copernicio,Nihonio,Flerovio,Moscovio,Livermorio,Tennessino,Oganes" & ChrW(243) & "n"
            Cells(m + 11, n + 21).FormulaR1C1 = "|"
            Cells(m + 11, n + 22).FormulaR1C1 = "Z_in -Z_fin ="
            Cells(m + 11, n + 23).FormulaR1C1 = "=-2*R[-4]C[1]"
            Cells(m + 11, n + 24).FormulaR1C1 = "=2*R[-4]C"
            Cells(m + 11, n + 25).FormulaR1C1 = "=0.2*R[-4]C[-1]"
            Cells(m + 11, n + 26).FormulaR1C1 = "|      en z:"
            Cells(m + 11, n + 27).FormulaR1C1 = "0"
            Cells(m + 3, n + 1).Interior.Color = "13998939"
            Cells(m + 3, n + 1).Font.Size = "14"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = "+         He"
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 9 Then ' vector 6
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(RC[1]<0, ""-          "", ""+         "") &R[1]C[3]"
            Cells(m + 3, n + 1).FormulaR1C1 = "=R[1]C[4]*1.6E-19"
            Cells(m + 3, n + 2).FormulaR1C1 = "||||||||||||||||||||||||||||||||||||||"
            Cells(m + 3, n + 5).FormulaR1C1 = "=MID(R[-2]C[15]&R[-1]C[15],IFERROR(FIND(""|"", SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","",""|"",R[1]C-1)),0)+1,FIND("";"",SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","","";"",R[1]C))-IFERROR(FIND(""|"", SUBSTITUTE(R[-2]C[15]&R[-1]C[15], "","",""|"",R[1]C-1)),0)-1)"
            Cells(m + 3, n + 20).FormulaR1C1 = "|1,H,1,|2,He,2,"
            Cells(m + 3, n + 21).FormulaR1C1 = "|"
            Cells(m + 3, n + 22).FormulaR1C1 = "rho_i -rho_f ="
            Cells(m + 3, n + 23).FormulaR1C1 = "=2*R[-5]C[1]"
            Cells(m + 3, n + 24).FormulaR1C1 = "=2*R[-5]C"
            Cells(m + 3, n + 25).FormulaR1C1 = "=0.3*R[-5]C[-1]"
            Cells(m + 3, n + 26).FormulaR1C1 = "|         Color:"
            Cells(m + 3, n + 27).FormulaR1C1 = "=10/R[-5]C[-3]"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=9"
            Cells(m + 4, n + 2).FormulaR1C1 = "S" & ChrW(237) & "mbolo:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=MID(R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[26]C[1]+1,R[27]C[1]-R[26]C[1]-1)"
            Cells(m + 4, n + 4).FormulaR1C1 = "         Z ="
            Cells(m + 4, n + 5).FormulaR1C1 = "2"
            Cells(m + 4, n + 6).FormulaR1C1 = "=IF(R[1]C[-3]<RC[-1],""< - Cambiar de elemento, o aumentar "" &RC[-1]-R[1]C[-3] & "" electron(es) mediante el bot" & ChrW(243) & "n  Actualizar"",IF(R[1]C[-3]>RC[-1],""< - Cambiar de elemento, o quitar "" &R[1]C[-3]-RC[-1] & "" electron(es) mediante el bot" & ChrW(243) & "n Actualizar."",""""))"
            Cells(m + 4, n + 20).FormulaR1C1 = "|3,Li,2,1,|4,Be,2,2,|5,B,2,3,|6,C,2,4,|7,N,2,5,|8,O,2,6,|9,F,2,7,|10,Ne,2,8,"
            Cells(m + 4, n + 21).FormulaR1C1 = "|"
            Cells(m + 4, n + 22).FormulaR1C1 = "phi_i -phi_f ="
            Cells(m + 4, n + 23).FormulaR1C1 = "0"
            Cells(m + 4, n + 24).FormulaR1C1 = "360"
            Cells(m + 4, n + 25).FormulaR1C1 = "10"
            Cells(m + 4, n + 26).FormulaR1C1 = "|      (en AD15 va la magnitud"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "1"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "Electrones:"
            Cells(m + 5, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-1]C&R[-2]C[-4]&""_*"")+COUNTIF(C[-1],R[-1]C&""_r_ion"")"
            Cells(m + 5, n + 5).FormulaR1C1 = "=IF(R[-1]C>RC[-2],R[-1]C[-2]&"" +""&ABS(R[-1]C-RC[-2]),IF(R[-1]C<RC[-2],R[-1]C[-2]&"" -""&ABS(R[-1]C-RC[-2]),""""))"
            Cells(m + 5, n + 20).FormulaR1C1 = "|11,Na,2,8,1,|12,Mg,2,8,2,|13,Al,2,8,3,|14,Si,2,8,4,|15,P,2,8,5,|16,S,2,8,6,|17,Cl,2,8,7,|18,Ar,2,8,8,"
            Cells(m + 5, n + 21).FormulaR1C1 = "|"
            Cells(m + 5, n + 22).FormulaR1C1 = "theta_i -theta_f ="
            Cells(m + 5, n + 23).FormulaR1C1 = "0"
            Cells(m + 5, n + 24).FormulaR1C1 = "180"
            Cells(m + 5, n + 25).FormulaR1C1 = "10"
            Cells(m + 5, n + 26).FormulaR1C1 = "|         del mayor vector)."
            Cells(m + 6, n + 2).FormulaR1C1 = "Posici" & ChrW(243) & "n x,y,z del " & ChrW(225) & "tomo:"
            Cells(m + 6, n + 4).FormulaR1C1 = "=""x ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 6, n + 5).FormulaR1C1 = "0"
            Cells(m + 6, n + 20).FormulaR1C1 = "|19,K,2,8,8,1,|20,Ca,2,8,8,2,|21,Sc,2,8,9,2,|22,Ti,2,8,10,2,|23,V,2,8,11,2,|24,Cr,2,8,13,1,|25,Mn,2,8,13,2,|26,Fe,2,8,14,2,|27,Co,2,8,15,2,|28,Ni,2,8,16,2,|29,Cu,2,8,18,1,|30,Zn,2,8,18,2,|31,Ga,2,8,18,3,|32,Ge,2,8,18,4,|33,As,2,8,18,5,|34,Se,2,8,18,6,|35,Br,2,8,18,7,|36,Kr,2,8,18,8,"
            Cells(m + 6, n + 21).FormulaR1C1 = "|__________________________________________________________________________________"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Rotar:"
            Cells(m + 7, n + 3).FormulaR1C1 = "0"
            Cells(m + 7, n + 4).FormulaR1C1 = "=""y ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 7, n + 5).FormulaR1C1 = "0"
            Cells(m + 7, n + 20).FormulaR1C1 = "|37,Rb,2,8,18,8,1,|38,Sr,2,8,18,8,2,|39,Y,2,8,18,9,2,|40,Zr,2,8,18,10,2,|41,Nb,2,8,18,12,1,|42,Mo,2,8,18,13,1,|43,Tc,2,8,18,13,2,|44,Ru,2,8,18,15,1,|45,Rh,2,8,18,16,1,|46,Pd,2,8,18,18,,|47,Ag,2,8,18,18,1,|48,Cd,2,8,18,18,2,|49,In,2,8,18,18,3,|50,Sn,2,8,18,18,4,|51,Sb,2,8,18,18,5,|52,Te,2,8,18,18,6,|53,I,2,8,18,18,7,|54,Xe,2,8,18,18,8,"
            Cells(m + 7, n + 21).FormulaR1C1 = "|     Distribuci" & ChrW(243) & "n de los electrones"
            Cells(m + 7, n + 24).FormulaR1C1 = "|"
            Cells(m + 7, n + 25).FormulaR1C1 = "Vistas:"
            Cells(m + 7, n + 26).FormulaR1C1 = "1"
            Cells(m + 8, n + 2).FormulaR1C1 = "0"
            Cells(m + 8, n + 3).FormulaR1C1 = "0"
            Cells(m + 8, n + 4).FormulaR1C1 = "=""z ""&IF(R10C26=1,""( " & ChrW(197) & " )"",""( m )"") &""  ="""
            Cells(m + 8, n + 5).FormulaR1C1 = "0"
            Cells(m + 8, n + 20).FormulaR1C1 = "|55,Cs,2,8,18,18,8,1,|56,Ba,2,8,18,18,8,2,|57,La,2,8,18,18,9,2,|58,Ce,2,8,18,19,9,2,|59,Pr,2,8,18,21,8,2,|60,Nd,2,8,18,22,8,2,|61,Pm,2,8,18,23,8,2,|62,Sm,2,8,18,24,8,2,|63,Eu,2,8,18,25,8,2,|64,Gd,2,8,18,25,9,2,|65,Tb,2,8,18,27,8,2,|66,Dy,2,8,18,28,8,2,|67,Ho,2,8,18,29,8,2,|68,Er,2,8,18,30,8,2,|69,Tm,2,8,18,31,8,2,|70,Yb,2,8,18,32,8,2,|71,Lu,2,8,18,32,9,2,|72,Hf,2,8,18,32,10,2,|73,Ta,2,8,18,32,11,2,|74,W,2,8,18,32,12,2,|75,Re,2,8,18,32,13,2,|76,Os,2,8,18,32,14,2,|77,Ir,2,8,18,32,15,2,|78,Pt,2,8,18,32,17,1,|79,Au,2,8,18,32,18,1,|80,Hg,2,8,18,32,18,2,|81,Tl,2,8,18,32,18,3,|82,Pb,2,8,18,32,18,4,|83,Bi,2,8,18,32,18,5,|84,Po,2,8,18,32,18,6,|85,At,2,8,18,32,18,7,|86,Rn,2,8,18,32,18,8,"
            Cells(m + 8, n + 21).FormulaR1C1 = "|    en el " & ChrW(225) & "tomo (distribuci" & ChrW(243) & "n esf" & ChrW(233) & "rica"
            Cells(m + 8, n + 24).FormulaR1C1 = "|"
            Cells(m + 8, n + 26).FormulaR1C1 = "1. En un punto del espacio"
            Cells(m + 9, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 9, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 9, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 9, n + 2).FormulaR1C1 = "Distrib. de electrones:"
            Cells(m + 9, n + 4).FormulaR1C1 = "   Radios:"
            Cells(m + 9, n + 5).FormulaR1C1 = "Valor:"
            Cells(m + 9, n + 20).FormulaR1C1 = "|87,Fr,2,8,18,32,18,8,1,|88,Ra,2,8,18,32,18,8,2,|89,Ac,2,8,18,32,18,9,2,|90,Th,2,8,18,32,18,10,2,|91,Pa,2,8,18,32,20,9,2,|92,U,2,8,18,32,21,9,2,|93,Np,2,8,18,32,22,9,2,|94,Pu,2,8,18,32,24,8,2,|95,Am,2,8,18,32,25,8,2,|96,Cm,2,8,18,32,25,9,2,|97,Bk,2,8,18,32,27,8,2,|98,Cf,2,8,18,32,28,8,2,|99,Es,2,8,18,32,29,8,2,|100,Fm,2,8,18,32,30,8,2,|101,Md,2,8,18,32,31,8,2,|102,No,2,8,18,32,32,8,2,|103,Lr,2,8,18,32,32,8,3,|104,Rf,2,8,18,32,32,10,2,|105,Db,2,8,18,32,32,11,2,|106,Sg,2,8,18,32,32,12,2,|107,Bh,2,8,18,32,32,13,2,|108,Hs,2,8,18,32,32,14,2,|109,Mt,2,8,18,32,32,15,2,|110,Ds,2,8,18,32,32,16,2,|111,Rg,2,8,18,32,32,17,2,|112,Cn,2,8,18,32,32,18,2,|113,Nh,2,8,18,32,32,18,3,|114,Fl,2,8,18,32,32,18,4,|115,Mc,2,8,18,32,32,18,5,|116,Lv,2,8,18,32,32,18,6,|117,Ts,2,8,18,32,32,18,7,|118,Og,2,8,18,32,32,18,8,"
            Cells(m + 9, n + 21).FormulaR1C1 = "|                   en A37, B37, C37):"
            Cells(m + 9, n + 24).FormulaR1C1 = "|"
            Cells(m + 9, n + 25).FormulaR1C1 = "=""o[""&R[-9]C&""]x=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]o2[""&R[-8]C&""]y=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]o3[""&R[-7]C&""]z=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]color=[""&R[-6]C[2]&""]origin[cart.]=[""&R[-9]C[2]&"";""&R[-8]C[2]&"";""&R[-7]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 9, n + 26).FormulaR1C1 = "2: En coord. Cartesianas (editable)"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 2).FormulaR1C1 = "       Total :"
            Cells(m + 10, n + 3).FormulaR1C1 = "=SUM(R[1]C:R[7]C)"
            Cells(m + 10, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_ion"""
            Cells(m + 10, n + 5).FormulaR1C1 = "=IFERROR(VLOOKUP(0,R[1]C[-2]:R[7]C,3,FALSE),"""")"
            Cells(m + 10, n + 20).FormulaR1C1 = "|_________________________________________________________________________________"
            Cells(m + 10, n + 21).FormulaR1C1 = "|         Rangos azimutal y polar:"
            Cells(m + 10, n + 24).FormulaR1C1 = "|"
            Cells(m + 10, n + 25).FormulaR1C1 = "o[0,1]x=[0;0]o2[0,1]y=[-2;3]o3[0,1]z=[-2;3]color=[10]origin[cart.]=[0;0;0]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"
            Cells(m + 10, n + 26).FormulaR1C1 = "3: En coord. Cartesianas (denso)"
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "8"
            Cells(m + 11, n + 2).FormulaR1C1 = "       En n = 1:"
            Cells(m + 11, n + 3).FormulaR1C1 = "=IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0)"
            Cells(m + 11, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_1"""
            Cells(m + 11, n + 5).FormulaR1C1 = "=(1^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 11, n + 6).FormulaR1C1 = "1s2"
            Cells(m + 11, n + 20).FormulaR1C1 = "|  Phi_ini ="
            Cells(m + 11, n + 21).FormulaR1C1 = "90"
            Cells(m + 11, n + 22).FormulaR1C1 = "Phi_fin ="
            Cells(m + 11, n + 23).FormulaR1C1 = "90"
            Cells(m + 11, n + 24).FormulaR1C1 = "|"
            Cells(m + 11, n + 25).FormulaR1C1 = "=""c[""&R[-8]C&""]rho=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]c2[""&R[-7]C&""]phi=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]c3[""&R[-9]C&""]z=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]color=[""&R[-8]C[2]&""]origin[cart.]=[""&R[-11]C[2]&"";""&R[-10]C[2]&"";""&R[-9]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 11, n + 26).FormulaR1C1 = "4. En coord. cil" & ChrW(237) & "ndricas"
            Cells(m + 3, n + 1).Interior.Color = "255"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 18 Then ' vector 5
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "       En n = 2:"
            Cells(m + 3, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 3, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_2"""
            Cells(m + 3, n + 5).FormulaR1C1 = "=(2^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 3, n + 20).FormulaR1C1 = "|  Theta_ini="
            Cells(m + 3, n + 21).FormulaR1C1 = "0"
            Cells(m + 3, n + 22).FormulaR1C1 = "Theta_fin="
            Cells(m + 3, n + 23).FormulaR1C1 = "360"
            Cells(m + 3, n + 24).FormulaR1C1 = "|"
            Cells(m + 3, n + 25).FormulaR1C1 = "=""s[""&R[-9]C&""]r=[""&R[-9]C[-2]&"";""&R[-9]C[-1]&""]s2[""&R[-8]C&""]phi=[""&R[-8]C[-2]&"";""&R[-8]C[-1]&""]s3[""&R[-7]C&""]theta=[""&R[-7]C[-2]&"";""&R[-7]C[-1]&""]color=[""&R[-9]C[2]&""]origin[cart.]=[""&R[-12]C[2]&"";""&R[-11]C[2]&"";""&R[-10]C[2]&""]FieldLayers[0]FieldLayersRange=[0;0]LayerThickness=[1]tfactor=0,008s"""
            Cells(m + 3, n + 26).FormulaR1C1 = "5. En coord. esf" & ChrW(233) & "ricas"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "       En n = 3:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 4, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_3"""
            Cells(m + 4, n + 5).FormulaR1C1 = "=(3^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 4, n + 20).FormulaR1C1 = "/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 2).FormulaR1C1 = "       En n = 4:"
            Cells(m + 5, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 5, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_4"""
            Cells(m + 5, n + 5).FormulaR1C1 = "=(4^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 5, n + 21).FormulaR1C1 = "1.  CONFIGURAR UN " & ChrW(193) & "TOMO:"
            Cells(m + 6, n + 2).FormulaR1C1 = "       En n = 5:"
            Cells(m + 6, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 6, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_5"""
            Cells(m + 6, n + 5).FormulaR1C1 = "=(5^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 6, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 6, n + 22).FormulaR1C1 = "Seleccionar el " & ChrW(225) & "tomo de la lista y oprimir el bot" & ChrW(243) & "n Actualizar."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 2).FormulaR1C1 = "       En n = 6:"
            Cells(m + 7, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 7, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_6"""
            Cells(m + 7, n + 5).FormulaR1C1 = "=(6^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 7, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 7, n + 22).FormulaR1C1 = "Editar su posici" & ChrW(243) & "n en el espacio en G18, G19 y G20 para el primer " & ChrW(225) & "tomo o en sus "
            Cells(m + 8, n + 2).FormulaR1C1 = "       En n = 7:"
            Cells(m + 8, n + 3).FormulaR1C1 = "=IF(R[-1]C=0,0,IFERROR(VALUE(MID( R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[20]C[1]+1,R[21]C[1]-R[20]C[1]-1)),0))"
            Cells(m + 8, n + 4).FormulaR1C1 = "=R16C5&R15C1&""_r_7"""
            Cells(m + 8, n + 5).FormulaR1C1 = "=(7^2 * 0.529*R10C26) / R[9]C"
            Cells(m + 8, n + 22).FormulaR1C1 = "correspondientes celdas para los dem" & ChrW(225) & "s " & ChrW(225) & "tomos."
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 3).FormulaR1C1 = "  APANTALLAMIENTO:"
            Cells(m + 9, n + 21).FormulaR1C1 = "2.  AGREGAR UN NUEVO " & ChrW(193) & "TOMO:"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 2).FormulaR1C1 = "Ver n" & ChrW(250) & "mero:"
            Cells(m + 10, n + 3).FormulaR1C1 = "0"
            Cells(m + 10, n + 4).FormulaR1C1 = "Sigma (apantall.) , Z_ef:"
            Cells(m + 10, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 10, n + 22).FormulaR1C1 = "Oprimir el bot" & ChrW(243) & "n Duplicar " & ChrW(225) & "tomo."
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 2).FormulaR1C1 = "Ver radio:"
            Cells(m + 11, n + 3).FormulaR1C1 = "0"
            Cells(m + 11, n + 4).FormulaR1C1 = "= (R[-9]C[-1]-1)*0.3"
            Cells(m + 11, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 11, n + 6).FormulaR1C1 = "d-f "
            Cells(m + 11, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 11, n + 22).FormulaR1C1 = "Deslizar la p" & ChrW(225) & "gina hacia abajo hasta encontrar la configuraci" & ChrW(243) & "n del " & ChrW(225) & "tomo duplicado."
            Cells(m + 3, n + 1).Interior.Color = "255"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 27 Then ' vector 4
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(R31C5=0,"""",R[10]C[3] & ""  ("" & ADDRESS(ROW(R[1]C[3]),COLUMN(R[1]C[3]),4) & "")"")"
            Cells(m + 3, n + 1).FormulaR1C1 = "=-1.6E-19"
            Cells(m + 3, n + 4).FormulaR1C1 = "=0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1)"
            Cells(m + 3, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 3, n + 6).FormulaR1C1 = "" & ChrW(8675) & ""
            Cells(m + 3, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 3, n + 22).FormulaR1C1 = "Editar su posici" & ChrW(243) & "n en el espacio en las coordenadas x,y,z"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=IF(R32C5=0,9,183)"
            Cells(m + 4, n + 2).FormulaR1C1 = "phi ="
            Cells(m + 4, n + 3).FormulaR1C1 = "=R23C23+(R23C25-R23C23)/R[8]C*R[9]C+R20C4"
            Cells(m + 4, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 4, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 4, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 4, n + 21).FormulaR1C1 = "3.  ELIMINAR UN " & ChrW(193) & "TOMO:"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=R32C5"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "theta ="
            Cells(m + 5, n + 3).FormulaR1C1 = "=R24C23+(R24C25-R24C23)/R[7]C*R[8]C+R20C5"
            Cells(m + 5, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 5, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 5, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 5, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 5, n + 22).FormulaR1C1 = "Oprimir el bot" & ChrW(243) & "n X del " & ChrW(225) & "tomo a eliminar."
            Cells(m + 6, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 6, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 6, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 6, n + 21).FormulaR1C1 = "4.  ESTUDIAR EL CAMPO EL" & ChrW(201) & "CTRICO EN UN PUNTO DEL ESPACIO:"
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C[4]*COS(RADIANS(R[-3]C[4]))*SIN(RADIANS(R[-2]C[4]))+R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C[3]*SIN(RADIANS(R[-3]C[3]))*SIN(RADIANS(R[-2]C[3]))+R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C[2]*COS(RADIANS(R[-2]C[2]))+R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Electr" & ChrW(243) & "n No."
            Cells(m + 7, n + 3).FormulaR1C1 = "=R[-18]C+1"
            Cells(m + 7, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 7, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 7, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 7, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 7, n + 22).FormulaR1C1 = "Seleccionar 1 en la lista L8 e ingresar las coordenadas del punto en A11,B11,C11. Oprimir " & ChrW(8629) & "."
            Cells(m + 8, n + 2).FormulaR1C1 = "=IF(R[-1]C[1]<=R23C5,R23C6,IF(R[-1]C[1]<=R24C5+R23C5,R24C6,IF(R[-1]C[1]<=R25C5+R24C5+R23C5,R25C6,IF(R[-1]C[1]<=R26C5+R25C5+R24C5+R23C5,R26C6,IF(R[-1]C[1]<=R27C5+R26C5+R25C5+R24C5+R23C5,R27C6,IF(R[-1]C[1]<=R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R28C6,IF(R[-1]C[1]<=R29C5+R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R29C6,R22C6)))))))"
            Cells(m + 8, n + 3).FormulaR1C1 = "=VLOOKUP(RC[-1],R22C6:R29C7,2,FALSE)"
            Cells(m + 8, n + 4).FormulaR1C1 = "=IF(RC[2]=0,1*SUM(R23C5:R[-11]C[-1]) + 0.85*R[-10]C[-1] + 0.35*(R[-9]C[-1]-1),1*(SUM(R23C5:R[-9]C[-1])-RC[2]) + 0.35*(RC[2]-1))"
            Cells(m + 8, n + 5).FormulaR1C1 = "=R16C7 - RC[-1]"
            Cells(m + 8, n + 6).FormulaR1C1 = "=MAX(IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""d"",R[-9]C,1),0)+1,3)),0),IFERROR(VALUE(MID(R[-9]C,IFERROR(FIND(""f"",R[-9]C,1),0)+1,3)),0))"
            Cells(m + 8, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 8, n + 22).FormulaR1C1 = "Las componentes del campo se observan en A12 para Ex, B12 para Ey, C12 para Ez."
            Cells(m + 9, n + -1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C1-R[-2]C)"
            Cells(m + 9, n + 0).FormulaR1C1 = "=IF(R32C5=0,"""",R19C2-R[-2]C)"
            Cells(m + 9, n + 1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C3-R[-2]C)"
            Cells(m + 9, n + 2).FormulaR1C1 = "Distrib. Espacial:"
            Cells(m + 9, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 9, n + 22).FormulaR1C1 = "La magnitud del campo el" & ChrW(233) & "ctrico resultante de todos los " & ChrW(225) & "tomos se observa en G9."
            Cells(m + 10, n + -1).FormulaR1C1 = "=IF(R32C5=0,1,6)"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 4).FormulaR1C1 = "Ref. en Tabla:"
            Cells(m + 10, n + 21).FormulaR1C1 = "            d)"
            Cells(m + 10, n + 22).FormulaR1C1 = "El campo el" & ChrW(233) & "ctrico del primer n" & ChrW(250) & "cleo se observa en la fila 30, del primer electr" & ChrW(243) & "n en la "
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "=IF(R32C5=0,8,2)"
            Cells(m + 11, n + 4).FormulaR1C1 = "=FIND(""|"" & R16C7 & "","",  R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22 )"
            Cells(m + 11, n + 22).FormulaR1C1 = "fila 48, y as" & ChrW(237) & " para los dem" & ChrW(225) & "s electrones. La fila de los n" & ChrW(250) & "cleos se etiqueta con E_0 (ver D30)."
            Cells(m + 3, n + 1).Interior.Color = "15773696"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 36 Then ' vector 3
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "=""Tot. en ""&R[-4]C"
            Cells(m + 3, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-4]C[-1])"
            Cells(m + 3, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 3, n + 21).FormulaR1C1 = "5.  ESTUDIAR EL CAMPO EL" & ChrW(201) & "CTRICO EN UNA REGI" & ChrW(211) & "N DEL ESPACIO:"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "No de carga:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=COUNTIF(R15C4:R[-4]C[-1],R[-5]C[-1])"
            Cells(m + 4, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 4, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 4, n + 22).FormulaR1C1 = "Seleccionar 2, 3, 4 " & ChrW(243) & " 5 en la lista en L8 y oprimir " & ChrW(8629) & " Campo. Configurar la zona de visualizaci" & ChrW(243) & "n "
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 5, n + 22).FormulaR1C1 = "en las correspondientes celdas de las columnas Y, Z, AA, AB y AC ,  filas 12 a la 17."
            Cells(m + 6, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 6, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 6, n + 22).FormulaR1C1 = "Para extraer una tabla de datos con todos los puntos del espacio seleccione SI en R8."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 7, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 7, n + 22).FormulaR1C1 = "Para regular visualmente el tama" & ChrW(241) & "o de los vectores  configure a prueba y error los valores"
            Cells(m + 8, n + -1).FormulaR1C1 = "1"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 8, n + 22).FormulaR1C1 = "de las celdas F8 y G8 (los valores var" & ChrW(237) & "an desde decimales hasta potencias grandes)"
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 9, n + 21).FormulaR1C1 = "6. UNIDADES:"
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 10, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 10, n + 22).FormulaR1C1 = "Ingrese Z10 = 1 para trabajar en Angstrom y Z10 = 1E-10 para trabajar en metros. "
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 11, n + 4).FormulaR1C1 = "=FIND("","", R15C22&R16C22&R17C22&R18C22&R19C22&R20C22&R21C22,R[-1]C+1)"
            Cells(m + 11, n + 20).FormulaR1C1 = "                ______________________________________________________________________________________"
            Cells(m + 3, n + 1).Interior.Color = "49407"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 45 Then ' vector 2
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 0).FormulaR1C1 = "=IF(R31C5=0,"""",R[10]C[3] & ""  ("" & ADDRESS(ROW(R[1]C[3]),COLUMN(R[1]C[3]),4) & "")"")"
            Cells(m + 3, n + 1).FormulaR1C1 = "=-1.6E-19"
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "=IF(R32C5=0,9,183)"
            Cells(m + 4, n + 2).FormulaR1C1 = "phi ="
            Cells(m + 4, n + 3).FormulaR1C1 = "=R23C23+(R23C25-R23C23)/R[8]C*R[9]C+R20C4"
            Cells(m + 4, n + 21).FormulaR1C1 = "OBSERVACIONES:"
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "=R32C5"
            Cells(m + 5, n + 1).FormulaR1C1 = "0"
            Cells(m + 5, n + 2).FormulaR1C1 = "theta ="
            Cells(m + 5, n + 3).FormulaR1C1 = "=R24C23+(R24C25-R24C23)/R[7]C*R[8]C+R20C5"
            Cells(m + 5, n + 21).FormulaR1C1 = "            a)"
            Cells(m + 5, n + 22).FormulaR1C1 = "Los radios de los electrones se calculan autom" & ChrW(225) & "ticamente para cada " & ChrW(225) & "tomo en particular "
            Cells(m + 6, n + 22).FormulaR1C1 = "utilizando el modelo de Bohr y las reglas de Slater de apantallamiento (las cuales tienen "
            Cells(m + 7, n + -1).FormulaR1C1 = "=R[1]C[4]*COS(RADIANS(R[-3]C[4]))*SIN(RADIANS(R[-2]C[4]))+R18C7"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R[1]C[3]*SIN(RADIANS(R[-3]C[3]))*SIN(RADIANS(R[-2]C[3]))+R19C7"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R[1]C[2]*COS(RADIANS(R[-2]C[2]))+R20C7"
            Cells(m + 7, n + 2).FormulaR1C1 = "Electr" & ChrW(243) & "n No."
            Cells(m + 7, n + 3).FormulaR1C1 = "=R[-18]C+1"
            Cells(m + 7, n + 22).FormulaR1C1 = "buena aproximaci" & ChrW(243) & "n para " & ChrW(225) & "tomos peque" & ChrW(241) & "os)."
            Cells(m + 8, n + 2).FormulaR1C1 = "=IF(R[-1]C[1]<=R23C5,R23C6,IF(R[-1]C[1]<=R24C5+R23C5,R24C6,IF(R[-1]C[1]<=R25C5+R24C5+R23C5,R25C6,IF(R[-1]C[1]<=R26C5+R25C5+R24C5+R23C5,R26C6,IF(R[-1]C[1]<=R27C5+R26C5+R25C5+R24C5+R23C5,R27C6,IF(R[-1]C[1]<=R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R28C6,IF(R[-1]C[1]<=R29C5+R28C5+R27C5+R26C5+R25C5+R24C5+R23C5,R29C6,R22C6)))))))"
            Cells(m + 8, n + 3).FormulaR1C1 = "=VLOOKUP(RC[-1],R22C6:R29C7,2,FALSE)"
            Cells(m + 8, n + 21).FormulaR1C1 = "            b)"
            Cells(m + 8, n + 22).FormulaR1C1 = "El campo el" & ChrW(233) & "ctrico para el " & ChrW(225) & "tomo o los " & ChrW(225) & "tomos se calcula autom" & ChrW(225) & "ticamente en cada "
            Cells(m + 9, n + -1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C1-R[-2]C)"
            Cells(m + 9, n + 0).FormulaR1C1 = "=IF(R32C5=0,"""",R19C2-R[-2]C)"
            Cells(m + 9, n + 1).FormulaR1C1 = "=IF(R32C5=0,"""",R19C3-R[-2]C)"
            Cells(m + 9, n + 2).FormulaR1C1 = "Distrib. Espacial:"
            Cells(m + 9, n + 22).FormulaR1C1 = "punto del espacio con la f" & ChrW(243) & "rmula cl" & ChrW(225) & "sica de la ley de Coulomb para electrones y protones"
            Cells(m + 10, n + -1).FormulaR1C1 = "=IF(R32C5=0,1,6)"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 22).FormulaR1C1 = "que no interact" & ChrW(250) & "an entre s" & ChrW(237) & " y se consideran cargas putuales. La mec" & ChrW(225) & "nica cu" & ChrW(225) & "ntica se "
            Cells(m + 11, n + -1).FormulaR1C1 = "1"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "=IF(R32C5=0,8,2)"
            Cells(m + 11, n + 22).FormulaR1C1 = "utiliza unicamente para calcular los radios. "
            Cells(m + 3, n + 1).Interior.Color = "15773696"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Call AddNewVector
      End If ' vector ends
      If m = m1 + 54 Then ' vector 1
            Cells(m + 3, n + -1).FormulaR1C1 = "=R[-9]C+1"
            Cells(m + 3, n + 2).FormulaR1C1 = "=""Tot. en ""&R[-4]C"
            Cells(m + 3, n + 3).FormulaR1C1 = "=COUNTIF(C[-1],R[-4]C[-1])"
            Cells(m + 3, n + 21).FormulaR1C1 = "            c)"
            Cells(m + 3, n + 22).FormulaR1C1 = "Para el c" & ChrW(225) & "lculo del campo  y para las cargas no se tienen en cuenta efectos cu" & ChrW(225) & "nticos."
            Cells(m + 4, n + -1).FormulaR1C1 = "1"
            Cells(m + 4, n + 0).FormulaR1C1 = "183"
            Cells(m + 4, n + 2).FormulaR1C1 = "No de carga:"
            Cells(m + 4, n + 3).FormulaR1C1 = "=COUNTIF(R15C4:R[-4]C[-1],R[-5]C[-1])"
            Cells(m + 4, n + 21).FormulaR1C1 = "            d)"
            Cells(m + 4, n + 22).FormulaR1C1 = "Inicialmente la distribuci" & ChrW(243) & "n espacial de los electrones se hace en el plano YZ, pero se puede "
            Cells(m + 5, n + -1).FormulaR1C1 = "1"
            Cells(m + 5, n + 0).FormulaR1C1 = "60*1"
            Cells(m + 5, n + 1).FormulaR1C1 = "1"
            Cells(m + 5, n + 22).FormulaR1C1 = "personalizar la zona de distribuci" & ChrW(243) & "n en coordenadas esf" & ChrW(233) & "ricas mediante los " & ChrW(225) & "ngulos "
            Cells(m + 6, n + 22).FormulaR1C1 = "azimutal en las celdas W23 y Y23, y polar en las celdas W24 y Y24."
            Cells(m + 7, n + -1).FormulaR1C1 = "=R11C1"
            Cells(m + 7, n + 0).FormulaR1C1 = "=R11C2"
            Cells(m + 7, n + 1).FormulaR1C1 = "=R11C3"
            Cells(m + 7, n + 21).FormulaR1C1 = "            e)"
            Cells(m + 7, n + 22).FormulaR1C1 = "La distribuci" & ChrW(243) & "n de electrones se hace con al primer n" & ChrW(250) & "mero " & ChrW(225) & "t" & ChrW(243) & "mico n de acuerdo a la "
            Cells(m + 8, n + -1).FormulaR1C1 = "1"
            Cells(m + 8, n + 0).FormulaR1C1 = "1"
            Cells(m + 8, n + 1).FormulaR1C1 = "1"
            Cells(m + 8, n + 22).FormulaR1C1 = "tabla peri" & ChrW(243) & "dica y se observa a partir de la celda E23 para el primer " & ChrW(225) & "tomo, y en las celdas"
            Cells(m + 9, n + -1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C,2)+POWER(R11C2-R[-11]C[1],2)+POWER(R11C3-R[-11]C[2],2),3/2))*(R11C1-R[-11]C)*R10C7*R[-15]C[2]"
            Cells(m + 9, n + 0).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-1],2)+POWER(R11C2-R[-11]C,2)+POWER(R11C3-R[-11]C[1],2),3/2))*(R11C2-R[-11]C)*R10C7*R[-15]C[1]"
            Cells(m + 9, n + 1).FormulaR1C1 = "=1/(POWER(POWER(R11C1-R[-11]C[-2],2)+POWER(R11C2-R[-11]C[-1],2)+POWER(R11C3-R[-11]C,2),3/2))*(R11C3-R[-11]C)*R10C7*R[-15]C"
            Cells(m + 9, n + 2).FormulaR1C1 = "=""E_""&R[-11]C[1]"
            Cells(m + 9, n + 22).FormulaR1C1 = "correspondientes para los dem" & ChrW(225) & "s " & ChrW(225) & "tomos. "
            Cells(m + 10, n + -1).FormulaR1C1 = "1"
            Cells(m + 10, n + 0).FormulaR1C1 = "0"
            Cells(m + 10, n + 1).FormulaR1C1 = "1"
            Cells(m + 10, n + 21).FormulaR1C1 = "            f)"
            Cells(m + 10, n + 22).FormulaR1C1 = "Para EXPORTAR un proyecto oprima el bot" & ChrW(243) & "n C" & ChrW(243) & "digo."
            Cells(m + 11, n + -1).FormulaR1C1 = "2"
            Cells(m + 11, n + 0).FormulaR1C1 = "0"
            Cells(m + 11, n + 1).FormulaR1C1 = "1"
            Cells(m + 3, n + 1).Interior.Color = "49407"
            Cells(m + 3, n + 1).Font.Size = "11"
            Cells(m + 3, n + 1).Font.name = "Calibri"
            Cells(m + 4, n - 1).Value = 1
            Cells(m1 + 1, n1 + 1).Value = ""
       Cells(m1 + 2, n1 - 1).Value = 7
      End If ' vector ends
      If m = m1 + 54 Then
            Cells(m + 12, n + 20).FormulaR1C1 = "                ______________________________________________________________________________________"
       Call BlackWhiteDesk
       Call PutEqBut
      End If ' actualizar hoja
End Sub
Sub PTableRefresh()
'Update changes in the coordinate system

    Dim Pos1 As Integer, Pos2 As Integer, Pos3 As Integer, Pos4 As Integer, Pos5 As Integer, Pos6 As Integer, Pos7 As Integer, Pos8 As Integer
    Dim EntireRefRow As Integer, EntireFinRow As Integer, ObjRefRow As Integer, ObjFinRow As Integer
    
    Pos1 = InStr(ActiveSheet.Shapes(Application.Caller).name, "(")
    Pos2 = InStr(ActiveSheet.Shapes(Application.Caller).name, ")")
    Pos3 = InStr(ActiveSheet.Shapes(Application.Caller).name, "[")
    Pos4 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "]")
    Pos5 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "(")
    Pos6 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, ")")
    Pos7 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "[")
    Pos8 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "]")
    On Error Resume Next
    EntireRefRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos1 + 1, Pos2 - Pos1 - 1)
    EntireFinRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos3 + 1, Pos4 - Pos3 - 1)
    ObjRefRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos5 + 1, Pos6 - Pos5 - 1)
    ObjFinRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos7 + 1, Pos8 - Pos7 - 1)
        
    Range("B2").Value = Abs(Cells(EntireRefRow + 2, 5).Value - Cells(EntireRefRow + 1, 7).Value)
    If Cells(EntireRefRow + 2, 5).Value < Cells(EntireRefRow + 1, 7).Value Then
        If Left(ActiveSheet.Shapes(Application.Caller).name, 7) = "DelButt" Then
            ActiveSheet.Shapes(Application.Caller).name = "AddButt(" & EntireRefRow & ")[" & EntireFinRow & "](" & ObjRefRow & ")[" & ObjFinRow & "]" & Right(ActiveSheet.Shapes(Application.Caller).name, 3)
            Exit Sub
        End If
    ElseIf Cells(EntireRefRow + 2, 5).Value > Cells(EntireRefRow + 1, 7).Value Then
        If Left(ActiveSheet.Shapes(Application.Caller).name, 7) = "AddButt" Then
            ActiveSheet.Shapes(Application.Caller).name = "DelButt(" & EntireRefRow & ")[" & EntireFinRow & "](" & ObjRefRow & ")[" & ObjFinRow & "]" & Right(ActiveSheet.Shapes(Application.Caller).name, 3)
            Exit Sub
        End If
    End If
sig:
    Call PTElectronicConfig(EntireRefRow + 7) ' Get electronic configurations
    Call AddObject ' Add or remove atoms
    Call UpdateShapeNamesPT(EntireRefRow, ObjRefRow, ObjFinRow - ObjRefRow + 1)  'Update reference cells for atomos
End Sub

Sub PTableDuplicateAtom()

'Segment PTableDuplicateAtom-01. Define variables
    Range("AB19").Value = 1
    Dim Pos1 As Integer, Pos2 As Integer, Pos3 As Integer, Pos4 As Integer, Pos5 As Integer, Pos6 As Integer, Pos7 As Integer, Pos8 As Integer
    Dim EntireRefRow As Integer, EntireFinRow As Integer, ObjRefRow As Integer, ObjFinRow As Integer
    
    Pos1 = InStr(ActiveSheet.Shapes(Application.Caller).name, "(")
    Pos2 = InStr(ActiveSheet.Shapes(Application.Caller).name, ")")
    Pos3 = InStr(ActiveSheet.Shapes(Application.Caller).name, "[")
    Pos4 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "]")
    Pos5 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "(")
    Pos6 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, ")")
    Pos7 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "[")
    Pos8 = InStr(Pos4 + 1, ActiveSheet.Shapes(Application.Caller).name, "]")
    On Error Resume Next
    EntireRefRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos1 + 1, Pos2 - Pos1 - 1)
    EntireFinRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos3 + 1, Pos4 - Pos3 - 1)
    ObjRefRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos5 + 1, Pos6 - Pos5 - 1)
    ObjFinRow = Mid(ActiveSheet.Shapes(Application.Caller).name, Pos7 + 1, Pos8 - Pos7 - 1)
    
'Segment PTableDuplicateAtom-02. Prepare cell values to duplicate and call the function to duplicate
    Range("B2").Value = "ENTIRE"
    Range("C3").Value = EntireFinRow
    Range("B3").FormulaR1C1 = "=IF(R[-1]C=""ENTIRE""," & EntireRefRow & "," & EntireRefRow + ObjFinRow - ObjRefRow + 1 & ")"
    
    Call AddObject

    Range("B2").Value = ""
    Range("C3").Value = ObjFinRow
    Range("B3").FormulaR1C1 = "=IF(R[-1]C=""ENTIRE""," & EntireRefRow & "," & ObjRefRow & ")"

'Segment PTableDuplicateAtom-03. Rename button and combobox names
    Call UpdateShapeNamesPT(EntireRefRow, ObjRefRow, ObjFinRow - ObjRefRow + 1)
    
End Sub

Sub UpdateShapeNamesPT(ByVal EntireRefRow As Integer, ObjIniRow As Integer, RowQty As Integer)
'EntireRefRow - Row where the ENTIRE object begins (atom), ObjIniRow - Row where the small object begins (electron), RowQty -number of rows of the small object (of one electron).

    Dim shp As Shape
    Dim RefValue As String
    Dim RightPart As String
    Dim EntireFinRow As Integer
    EntireRefRow = 15
    RefValue = Range("D30").Value ' the value of reference, E_0, V_0, etc. between two atoms

    For Each shp In ActiveSheet.Shapes
        If shp.Type = msoFormControl Then
            
            If shp.FormControlType = xlDropDown Then
                If Left(shp.name, 8) = "Elements" Then
                    shp.name = "Elements" & shp.TopLeftCell.Row
                    shp.Select
                    With Selection
                        .LinkedCell = Cells(shp.TopLeftCell.Row + 1, 7).Address
                    End With
                End If
            End If
            If shp.FormControlType = xlSpinner Then
                If Left(shp.name, 8) = "Spinner1" Then
                    shp.name = "Spinner1" & shp.TopLeftCell.Row
                    shp.Select
                    With Selection
                        .LinkedCell = Cells(shp.TopLeftCell.Row + 1, 4).Address
                    End With
                End If
                If Left(shp.name, 8) = "Spinner2" Then
                    shp.name = "Spinner2" & shp.TopLeftCell.Row
                    shp.Select
                    With Selection
                        .LinkedCell = Cells(shp.TopLeftCell.Row + 1, 5).Address
                    End With
                End If
            End If
            ActiveSheet.Shapes("Conf_" & 24).Select
            
            If shp.FormControlType = xlButtonControl Then 'Update all the names of the buttons
            RightPart = Mid(shp.name, InStr(1, shp.name, "]", 0) + 1)
                If Right(shp.name, 2) = "PT" Then
                    i = 1
                    Do While Cells(shp.TopLeftCell.Row + EntireRefRow + i * RowQty, 4).Value <> ""
                    
                        If Cells(shp.TopLeftCell.Row + EntireRefRow + i * RowQty, 4).Value = RefValue Then
                            EntireFinRow = Cells(shp.TopLeftCell.Row + i * RowQty, 4).Row - 1
                            GoTo GotFinRow
                        ElseIf Cells(shp.TopLeftCell.Row + ObjIniRow + i * RowQty, 4).Value = "" Then
                            EntireFinRow = Cells(shp.TopLeftCell.Row + (i + 1) * RowQty, 4).Row - 1
                            GoTo GotFinRow
                        End If
                        i = i + 1
                    Loop
GotFinRow:
                    shp.name = Left(shp.name, 8) & shp.TopLeftCell.Row & ")[" & EntireFinRow & "]" & RightPart
                End If
            End If
            
        End If
    Next shp
End Sub

Sub PTCleanTable()
        Dim r As Range
        Dim last As Single
        Set r = ActiveSheet.Range("A6")
        ActiveSheet.Range("T8").Value = 1
        'Clean table
        If Cells(r.Row + 7, r.Column + 1).Value > 0 And Cells(r.Row + 8, r.Column + 1).Value > 0 Then 'verify if data exists
            If Cells(Cells(r.Row + 7, r.Column + 1).Value, Cells(r.Row + 8, r.Column + 1).Value).Value <> "" Then
                i = 1
                Do While Cells(Cells(r.Row + 7, r.Column + 1).Value + i, Cells(r.Row + 8, r.Column + 1).Value).Value <> ""
                    i = i + 1
                Loop
            End If
            Range(Cells(Cells(r.Row + 7, r.Column + 1).Value - 4, Cells(r.Row + 8, r.Column + 1).Value), Cells(Cells(r.Row + 7, r.Column + 1).Value + i, Cells(r.Row + 8, r.Column + 1).Value + 9)).Select
            Selection.ClearContents
            Range("H10").Select
        End If
        'End of clean table
        ActiveSheet.Range("T8").Value = 2
        Range("B13").FormulaR1C1 = "=IF(R[-5]C[18]=1,50,0)"
        Range("B14").FormulaR1C1 = "=IF(R[-6]C[18]=1,10,0)"
End Sub
Sub PTRotateElectrons()

' Set field view to a point in space
    Range("AB19").Value = 1
    
' Set the dynamic angles and rotate
    Range("W23").FormulaR1C1 = "=0+R[-18]C[-14]"
    Range("W24").FormulaR1C1 = "=0+R[-19]C[-14]*2"
    Range("Y23").FormulaR1C1 = "=360+R[-18]C[-16]"
    Range("Y24").FormulaR1C1 = "=180+R[-19]C[-16]*2"
    
    Call rotate_n
    
' Set the default values and default view
    Range("W23").FormulaR1C1 = 90
    Range("W24").FormulaR1C1 = 0
    Range("Y23").FormulaR1C1 = 90
    Range("Y24").FormulaR1C1 = 360
    
    Call Reset
    
End Sub

Sub PTElectronicConfig(ByVal ConfRow As Integer)
'Electronic configuration output

'Segment PTElectronicConfig-01. Define variables
    Dim Z As Integer
    Dim config As String
    Dim electronesRestantes As Integer
    Dim n As Integer, l As Integer
    Dim orbital As Variant
    Dim e As Integer, max_e As Integer
    Dim configPorNivel(1 To 7) As String ' Array to store config by level (n=1 a 7)
    
'Segment PTElectronicConfig-02. Define atomic number
    On Error Resume Next
    Z = Range("G" & ConfRow - 6).Value
    On Error GoTo 0
    
'Segment PTElectronicConfig-03. Validate Z
    If Z < 1 Or Z > 118 Then
        MsgBox "Atomic number must be between 1 and 118", vbExclamation
        Exit Sub
    End If
    
    electronesRestantes = Z
    
'Segment PTElectronicConfig-04. Initialize array
    For n = 1 To 7
        configPorNivel(n) = ""
    Next n
    
'Segment PTElectronicConfig-05. Filling according to Madelung's rule (n+l)
    Dim ordenLlenado() As Variant
    ordenLlenado = Array("1s", "2s", "2p", "3s", "3p", "4s", "3d", "4p", "5s", "4d", "5p", _
                         "6s", "4f", "5d", "6p", "7s", "5f", "6d", "7p")
    
    'Handling known exceptions
    If Z = 24 Then ' Cromo
        configPorNivel(1) = "1s2"
        configPorNivel(2) = "2s2 2p6"
        configPorNivel(3) = "3s2 3p6 3d5"
        configPorNivel(4) = "4s1"
    ElseIf Z = 29 Then ' Cobre
        configPorNivel(1) = "1s2"
        configPorNivel(2) = "2s2 2p6"
        configPorNivel(3) = "3s2 3p6 3d10"
        configPorNivel(4) = "4s1"
    Else
        ' Normal filling
        For Each orbital In ordenLlenado
            If electronesRestantes <= 0 Then Exit For
            
            n = CInt(Left(orbital, 1))
            l = InStr("spdf", Right(orbital, 1)) - 1
            
            Select Case l
                Case 0: max_e = 2  ' s
                Case 1: max_e = 6  ' p
                Case 2: max_e = 10 ' d
                Case 3: max_e = 14 ' f
            End Select
            
            e = Application.Min(max_e, electronesRestantes)
            If e > 0 Then
                configPorNivel(n) = configPorNivel(n) & orbital & e & " "
                electronesRestantes = electronesRestantes - e
            End If
        Next orbital
    End If
    
'Segment PTElectronicConfig-06. show results (n=1 a n=7)
    For n = 1 To 7
        If configPorNivel(n) <> "" Then
            Range("H" & (ConfRow + n)).Value = Trim(configPorNivel(n))
        Else
            Range("H" & (ConfRow + n)).Value = "" ' Limpiar celda si no hay electrones
        End If
    Next n
    
End Sub


